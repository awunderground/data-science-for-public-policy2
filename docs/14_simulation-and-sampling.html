<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Science for Public Policy - 13&nbsp; Simulation and Sampling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./15_microsimulation.html" rel="next">
<link href="./13_web-scraping.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="www/styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./14_simulation-and-sampling.html">Statistics</a></li><li class="breadcrumb-item"><a href="./14_simulation-and-sampling.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Simulation and Sampling</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science for Public Policy</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_intro-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to the tidyverse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_advanced-data-cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Advanced Data Cleaning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_data-viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Visualization with ggplot2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_exploratory-data-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Reproducible Research</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_reproducible-research-with-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reproducible Research with Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_advanced-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Advanced Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_reproducible-research-with-git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Reproducible Research with Git and GitHub</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_advanced-git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Advanced Git and Github</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Programming</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Advanced R Programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_apis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Web Application Programming Interfaces (Web APIs)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_web-scraping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Web Scraping</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_simulation-and-sampling.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Simulation and Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_microsimulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Microsimulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_nonparametric-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Nonparametric Curve Fitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_nonparametric-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Nonparametric Inference</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Supervised Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19_predictive-modeling-motivation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Predictive Modeling Motivation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20_predictive-modeling-concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Predictive Modeling Concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22_ensembling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Ensembling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23_regularization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Regularization</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Unsupervised Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25_dimension-reduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Dimension Reduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./26_unsupervised-ml-cluster-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Cluster Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./27_advanced-unsupervised-ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Mixture Distributions and Mixture Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./28_text-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Text Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./29_text-modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Text Modeling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Other Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./30_geospatial-sf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Geospatial Analysis with sf</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-review5" id="toc-sec-review5" class="nav-link active" data-scroll-target="#sec-review5"><span class="header-section-number">13.1</span> Review</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">13.2</span> Introduction</a></li>
  <li><a href="#fundamentals-of-probability-theory" id="toc-fundamentals-of-probability-theory" class="nav-link" data-scroll-target="#fundamentals-of-probability-theory"><span class="header-section-number">13.3</span> Fundamentals of Probability Theory</a></li>
  <li><a href="#discrete-random-variables" id="toc-discrete-random-variables" class="nav-link" data-scroll-target="#discrete-random-variables"><span class="header-section-number">13.4</span> Discrete Random Variables</a>
  <ul class="collapse">
  <li><a href="#bernoulli-distribution" id="toc-bernoulli-distribution" class="nav-link" data-scroll-target="#bernoulli-distribution"><span class="header-section-number">13.4.1</span> Bernoulli Distribution</a></li>
  <li><a href="#binomial-distribution" id="toc-binomial-distribution" class="nav-link" data-scroll-target="#binomial-distribution"><span class="header-section-number">13.4.2</span> Binomial Distribution</a></li>
  <li><a href="#distributions-using-r" id="toc-distributions-using-r" class="nav-link" data-scroll-target="#distributions-using-r"><span class="header-section-number">13.4.3</span> Distributions Using R</a></li>
  <li><a href="#poisson-random-variable" id="toc-poisson-random-variable" class="nav-link" data-scroll-target="#poisson-random-variable"><span class="header-section-number">13.4.4</span> Poisson Random Variable</a></li>
  <li><a href="#categorical-random-variable" id="toc-categorical-random-variable" class="nav-link" data-scroll-target="#categorical-random-variable"><span class="header-section-number">13.4.5</span> Categorical Random Variable</a></li>
  </ul></li>
  <li><a href="#continuous-random-variables" id="toc-continuous-random-variables" class="nav-link" data-scroll-target="#continuous-random-variables"><span class="header-section-number">13.5</span> Continuous Random Variables</a>
  <ul class="collapse">
  <li><a href="#uniform-distribution" id="toc-uniform-distribution" class="nav-link" data-scroll-target="#uniform-distribution"><span class="header-section-number">13.5.1</span> Uniform Distribution</a></li>
  <li><a href="#normal-distribution" id="toc-normal-distribution" class="nav-link" data-scroll-target="#normal-distribution"><span class="header-section-number">13.5.2</span> Normal Distribution</a></li>
  <li><a href="#exponential-distribution" id="toc-exponential-distribution" class="nav-link" data-scroll-target="#exponential-distribution"><span class="header-section-number">13.5.3</span> Exponential Distribution</a></li>
  <li><a href="#other-distributions" id="toc-other-distributions" class="nav-link" data-scroll-target="#other-distributions"><span class="header-section-number">13.5.4</span> Other Distributions</a></li>
  </ul></li>
  <li><a href="#parametric-density-estimation" id="toc-parametric-density-estimation" class="nav-link" data-scroll-target="#parametric-density-estimation"><span class="header-section-number">13.6</span> Parametric Density Estimation</a>
  <ul class="collapse">
  <li><a href="#maximum-likelihood-estimation" id="toc-maximum-likelihood-estimation" class="nav-link" data-scroll-target="#maximum-likelihood-estimation"><span class="header-section-number">13.6.1</span> Maximum Likelihood Estimation</a></li>
  </ul></li>
  <li><a href="#multivariate-random-variables" id="toc-multivariate-random-variables" class="nav-link" data-scroll-target="#multivariate-random-variables"><span class="header-section-number">13.7</span> Multivariate Random Variables</a>
  <ul class="collapse">
  <li><a href="#multivariate-normal-distribution" id="toc-multivariate-normal-distribution" class="nav-link" data-scroll-target="#multivariate-normal-distribution"><span class="header-section-number">13.7.1</span> Multivariate Normal Distribution</a></li>
  </ul></li>
  <li><a href="#monte-carlo-methods" id="toc-monte-carlo-methods" class="nav-link" data-scroll-target="#monte-carlo-methods"><span class="header-section-number">13.8</span> Monte Carlo Methods</a>
  <ul class="collapse">
  <li><a href="#example-1-coin-tossing" id="toc-example-1-coin-tossing" class="nav-link" data-scroll-target="#example-1-coin-tossing"><span class="header-section-number">13.8.1</span> Example 1: Coin Tossing</a></li>
  <li><a href="#example-2-bootstrap-sampling" id="toc-example-2-bootstrap-sampling" class="nav-link" data-scroll-target="#example-2-bootstrap-sampling"><span class="header-section-number">13.8.2</span> Example 2: Bootstrap Sampling</a></li>
  <li><a href="#example-3-pi" id="toc-example-3-pi" class="nav-link" data-scroll-target="#example-3-pi"><span class="header-section-number">13.8.3</span> Example 3: <span class="math inline">\(\pi\)</span></a></li>
  <li><a href="#example-4-simple-linear-regression" id="toc-example-4-simple-linear-regression" class="nav-link" data-scroll-target="#example-4-simple-linear-regression"><span class="header-section-number">13.8.4</span> Example 4: Simple Linear Regression</a></li>
  <li><a href="#example-5-queuing-example" id="toc-example-5-queuing-example" class="nav-link" data-scroll-target="#example-5-queuing-example"><span class="header-section-number">13.8.5</span> Example 5: Queuing Example</a></li>
  <li><a href="#more-examples-of-monte-carlo-simulation" id="toc-more-examples-of-monte-carlo-simulation" class="nav-link" data-scroll-target="#more-examples-of-monte-carlo-simulation"><span class="header-section-number">13.8.6</span> More examples of Monte Carlo simulation</a></li>
  <li><a href="#one-final-note" id="toc-one-final-note" class="nav-link" data-scroll-target="#one-final-note"><span class="header-section-number">13.8.7</span> One Final Note</a></li>
  </ul></li>
  <li><a href="#sampling-from-observed-data" id="toc-sampling-from-observed-data" class="nav-link" data-scroll-target="#sampling-from-observed-data"><span class="header-section-number">13.9</span> Sampling from Observed Data</a>
  <ul class="collapse">
  <li><a href="#sampling" id="toc-sampling" class="nav-link" data-scroll-target="#sampling"><span class="header-section-number">13.9.1</span> Sampling</a></li>
  <li><a href="#resampling" id="toc-resampling" class="nav-link" data-scroll-target="#resampling"><span class="header-section-number">13.9.2</span> Resampling</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./14_simulation-and-sampling.html">Statistics</a></li><li class="breadcrumb-item"><a href="./14_simulation-and-sampling.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Simulation and Sampling</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Simulation and Sampling</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sec-review5" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="sec-review5"><span class="header-section-number">13.1</span> Review</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Population
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <strong>population</strong> is the entire set of observations of interest.</p>
<p>For example, a population could be everyone residing in France at a point in time. A different population could be every American ages 65 or older.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Parameter
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <strong>parameter</strong> is a numerical quantity that summarizes a population.</p>
<p>For example, the population mean and population standard deviation describe important characteristics of many populations.</p>
<p>More generally, location parameters, scale parameters, and shape parameters describe many populations.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Random Sample
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <strong>random sample</strong> is a random subset of a population.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Statistics
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <strong>statistic</strong> is a numerical quantity that summarizes a sample.</p>
<p>For example, the sample mean and sample standard deviation describe important characteristics of many random samples.</p>
</div>
</div>
<p>Parameters are to populations what statistics are to samples. The process of learning about population parameters from statistics calculated from samples is called <strong>statistical inference</strong>.</p>
</section>
<section id="introduction" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="introduction"><span class="header-section-number">13.2</span> Introduction</h2>
<p>Simulation and sampling are important tools for statistics and data science. After reviewing/introducing basic concepts about probability theory and probability distributions, we will discuss two important applications of simulation and sampling.</p>
<ol type="1">
<li><strong>Monte Carlo simulation:</strong> A class of methods where values are repeatedly sampled/simulated from theoretical distributions that model a data generation process. Theoretical distributions, like the normal distribution, have closed-from representations and a finite number of parameters like mean and variance.</li>
<li><strong>Resampling methods:</strong> A class of methods where values are repeatedly sampled from observed data to approximate repeatedly sampling from a population. Bootstrapping is a common resampling method.</li>
</ol>
<p>Monte Carlo methods and resampling methods have a wide range of applications. Monte Carlo simulation is used by election forecasters to predict electoral outcomes and econometricians to understand the properties of estimators. Resampling methods are used in machine learning and causal inference. Both are fundamental methods for agent-based models including microsimulation.</p>
</section>
<section id="fundamentals-of-probability-theory" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="fundamentals-of-probability-theory"><span class="header-section-number">13.3</span> Fundamentals of Probability Theory</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Random Variable
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(X\)</span> is a random variable if its value is unknown and/or could change.</p>
</div>
</div>
<p><span class="math inline">\(X\)</span> could be the outcome from the flip of a coin or the roll of a die. <span class="math inline">\(X\)</span> could also be the amount of rain next July 4th.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Experiment
</div>
</div>
<div class="callout-body-container callout-body">
<p>An <strong>experiment</strong> is a process that results in a fixed set of possible outcomes.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Set
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <strong>set</strong> is a collection of objects.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Sample Space
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <strong>sample space</strong> is the set of all possible outcomes for an experiment. We will denote a sample space with <span class="math inline">\(\Omega\)</span>.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Discrete Random Variable
</div>
</div>
<div class="callout-body-container callout-body">
<p>A set is countable if there is a one-to-one correspondence from the elements of the set to some (finite) or all (countably infinite) positive integers (i.e.&nbsp;1 = heads and 2 = tails).</p>
<p>A random variable is discrete if its sample space is countable (finite or countably infinite).</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Continuous Random Variable
</div>
</div>
<div class="callout-body-container callout-body">
<p>A random variable is continuous if its sample space is any value in a <span class="math inline">\(\mathbb{R}\)</span> (real) interval.</p>
<p>There are infinite possible values in a real interval so the sample space is uncountable.</p>
</div>
</div>
</section>
<section id="discrete-random-variables" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="discrete-random-variables"><span class="header-section-number">13.4</span> Discrete Random Variables</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Probability Mass Function
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <strong>probability mass function (PMF)</strong> computes the probability of an event in the sample space of a discrete random variable.</p>
<p><span id="eq-pmf"><span class="math display">\[
p(x) = P(X = x)
\tag{13.1}\]</span></span></p>
<p>where <span class="math inline">\(0 \le p(x) \le 1\)</span> and <span class="math inline">\(\sum_{x \in \Omega} p(x) = 1\)</span></p>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">tibble</span>(</span>
<span id="cb1-2"><a href="#cb1-2"></a>  <span class="at">a =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>),</span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="st">`</span><span class="at">P(X = a)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb1-4"><a href="#cb1-4"></a>) <span class="sc">|&gt;</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(a, <span class="st">`</span><span class="at">P(X = a)</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"PMF for rolling a fair die"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-die" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-die-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.1: PMF for rolling a fair die
</figcaption>
<div aria-describedby="fig-die-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="14_simulation-and-sampling_files/figure-html/fig-die-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<p>Now we can make statements like <span class="math inline">\(P(X = a)\)</span>. For example, <span class="math inline">\(P(X = 3) = \frac{1}{6}\)</span>.</p>
<section id="bernoulli-distribution" class="level3" data-number="13.4.1">
<h3 data-number="13.4.1" class="anchored" data-anchor-id="bernoulli-distribution"><span class="header-section-number">13.4.1</span> Bernoulli Distribution</h3>
<p>A <a href="https://en.wikipedia.org/wiki/Bernoulli_distribution">Bernoulli random variable</a> takes on the value <span class="math inline">\(1\)</span> with probability <span class="math inline">\(p\)</span> and <span class="math inline">\(0\)</span> with probability <span class="math inline">\(1 - p\)</span>. It is often used to represent coins. When <span class="math inline">\(p = \frac{1}{2}\)</span> we refer to the coin as “fair”.</p>
<p>We show that a random variable is Bernoulli distributed with</p>
<p><span id="eq-bernoulli"><span class="math display">\[
X \sim Ber(p)
\tag{13.2}\]</span></span></p>
<p>The PMF of a Bernoulli random variable is</p>
<p><span id="eq-bernoulli-pmf"><span class="math display">\[
p(x) =
\begin{cases}
1 - p &amp;\text{ if } x = 0 \\
p &amp;\text{ if } x = 1
\end{cases} = p^x(1 - p)^{1-x}
\tag{13.3}\]</span></span></p>
</section>
<section id="binomial-distribution" class="level3" data-number="13.4.2">
<h3 data-number="13.4.2" class="anchored" data-anchor-id="binomial-distribution"><span class="header-section-number">13.4.2</span> Binomial Distribution</h3>
<p>A <a href="https://en.wikipedia.org/wiki/Binomial_distribution">binomial random variable</a> is the number of events observed in <span class="math inline">\(n\)</span> repeated Bernoulli trials.</p>
<p>We show that a random variable is Bernoulli distributed with</p>
<p><span id="eq-binomial"><span class="math display">\[
X \sim Bin(n, p)
\tag{13.4}\]</span></span></p>
<p>The PMF of a Bernoulli random variable is</p>
<p><span id="eq-binomial-pmf"><span class="math display">\[
p(x) = {n \choose x} p^x(1 - p)^{n - x}
\tag{13.5}\]</span></span></p>
<p>We can calculate the theoretical probability of a given draw from a binomial distribution using this PDF. For example, suppose we have a binomial distribution with <span class="math inline">\(10\)</span> trials and <span class="math inline">\(p = \frac{1}{2}\)</span>. The probability of drawing exactly six <span class="math inline">\(1\)</span>s and four <span class="math inline">\(0\)</span>s is</p>
<p><span id="eq-binomial-example"><span class="math display">\[
p(X = 6) = \frac{10!}{6!4!} 0.5^6(1 - 0.5)^{10 - 6} \approx 0.2051
\tag{13.6}\]</span></span></p>
<p>We can do similar calculations for each value between <span class="math inline">\(0\)</span> and <span class="math inline">\(10\)</span>.</p>
<p>We can also take random draws from the distribution. <a href="#fig-binomial" class="quarto-xref">Figure&nbsp;<span>13.2</span></a> shows 1,000 random draws from a binomial distribution with 10 trials and <code>p = 0.5</code>. The theoretical distribution is overlaid in red.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">tibble</span>(</span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="at">x =</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a>) <span class="sc">|&gt;</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count)))) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">y =</span> <span class="fu">map_dbl</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, dbinom, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)),</span>
<span id="cb2-8"><a href="#cb2-8"></a>             <span class="fu">aes</span>(x, y),</span>
<span id="cb2-9"><a href="#cb2-9"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>  <span class="fu">labs</span>(</span>
<span id="cb2-11"><a href="#cb2-11"></a>    <span class="at">title =</span> <span class="st">"1,000 samples of a binomial RV"</span>,</span>
<span id="cb2-12"><a href="#cb2-12"></a>    <span class="at">subtitle =</span> <span class="st">"Size = 10; prob = 0.5"</span>,</span>
<span id="cb2-13"><a href="#cb2-13"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-binomial" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-binomial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.2: 1,000 random draws from a binomial distribution with 10 trials and p = 0.5
</figcaption>
<div aria-describedby="fig-binomial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="14_simulation-and-sampling_files/figure-html/fig-binomial-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Sampling Error
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Sampling error</strong> is the difference between sample statistics (estimates of population parameters) and population parameters.</p>
</div>
</div>
<p>The difference between the red dots and black bars in <a href="#fig-binomial" class="quarto-xref">Figure&nbsp;<span>13.2</span></a> is caused by sampling error.</p>
</section>
<section id="distributions-using-r" class="level3" data-number="13.4.3">
<h3 data-number="13.4.3" class="anchored" data-anchor-id="distributions-using-r"><span class="header-section-number">13.4.3</span> Distributions Using R</h3>
<p>Most common distributions have R functions to</p>
<ul>
<li>calculate the density of the pdf/pmf for a specific value</li>
<li>calculate the probability of observing a value less than <span class="math inline">\(a\)</span></li>
<li>calculate the value associated with specific quantiles of the pdf/pmf</li>
<li>randomly sample from the probability distribution</li>
</ul>
<p>Let’s consider a few examples:</p>
<p>The following answers the question: “What is the probability of observing 10 events in 10 trials when <code>p = 0.5</code>?”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">10</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0009765625</code></pre>
</div>
</div>
<p><br></p>
<p>The following answers the question: “What’s the probability of observing 3 or fewer events in 10 trials when <code>p = 0.5</code>”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">pbinom</span>(<span class="at">q =</span> <span class="dv">3</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.171875</code></pre>
</div>
</div>
<p><br></p>
<p>The following answers the question: “What is a 10th percentile number of events to see in 10 trials when <code>p = 0.5</code>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">qbinom</span>(<span class="at">p =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p><br></p>
<p>The following randomly draw ten different binomially distributed random variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 7 5 4 8 6 5 6 6 4 2</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color:#1696d2;">Exercise 1</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Add <code>dbinom()</code> for 0, 1, and 2 when <code>size = 10</code> and <code>prob = 0.5</code>.</li>
<li>Calculate <code>pbinom()</code> with <code>size = 10</code> and <code>prob = 0.5</code>. Why do you get the same answer?</li>
<li>Plug the result from step 1/step 2 into <code>qbinom()</code> with <code>size = 10</code> and <code>prob = 0.5</code>. Why do you get the answer <code>2</code>?</li>
<li>Use <code>rbinom()</code> with <code>size = 10</code> and <code>prob = 0.5</code> to sample 10,000 binomially distributed random variables and assign the output to <code>x</code>. Calculate <code>mean(x &lt;= 2)</code>. How does the answer compare to step 1/step 2?</li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pseudo-random numbers
</div>
</div>
<div class="callout-body-container callout-body">
<p>Computers use pseudo-random numbers to generate samples from probability distributions. Modern pseudo-random samplers are very random.</p>
<p>Use <code>set.seed()</code> to make pseudo-random sampling reproducible.</p>
</div>
</div>
</section>
<section id="poisson-random-variable" class="level3" data-number="13.4.4">
<h3 data-number="13.4.4" class="anchored" data-anchor-id="poisson-random-variable"><span class="header-section-number">13.4.4</span> Poisson Random Variable</h3>
<p>A <a href="https://en.wikipedia.org/wiki/Poisson_distribution">poisson random variable</a> is the number of events that occur in a fixed period of time. For example, a poisson distribution can be used to model the number of visits in an emergency room between 1AM and 2AM.</p>
<p>We show that a random variable is poisson-distributed with</p>
<p><span id="eq-poisson"><span class="math display">\[
X \sim Pois(\lambda)
\tag{13.7}\]</span></span></p>
<p>The parameter <span class="math inline">\(\lambda\)</span> is both the mean and variance of the poisson distribution. The PMF of a poisson random variable is</p>
<p><span id="eq-poisson-pmf"><span class="math display">\[
p(x) = \frac{\lambda^x e^{-\lambda}}{x!}
\tag{13.8}\]</span></span></p>
<p><a href="#fig-poisson" class="quarto-xref">Figure&nbsp;<span>13.3</span></a> shows 1,000 draws from a poisson distribution with <span class="math inline">\(\lambda = 10\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">set.seed</span>(<span class="dv">20200905</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="fu">tibble</span>(</span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="at">x =</span> <span class="fu">rpois</span>(<span class="dv">1000</span>, <span class="at">lambda =</span> <span class="dv">10</span>)</span>
<span id="cb11-5"><a href="#cb11-5"></a>) <span class="sc">|&gt;</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count)))) <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">29</span>)) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dpois, <span class="at">n =</span> <span class="dv">30</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">lambda =</span> <span class="dv">10</span>)) <span class="sc">+</span> </span>
<span id="cb11-10"><a href="#cb11-10"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-11"><a href="#cb11-11"></a>    <span class="at">title =</span> <span class="st">"1,000 samples of a Poisson RV"</span>,</span>
<span id="cb11-12"><a href="#cb11-12"></a>    <span class="at">subtitle =</span> <span class="st">"Observed data in black and theoretical distribution in red"</span>,</span>
<span id="cb11-13"><a href="#cb11-13"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb11-14"><a href="#cb11-14"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_bar()`).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-poisson" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.3: 1,000 samples of a Poisson RV
</figcaption>
<div aria-describedby="fig-poisson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="14_simulation-and-sampling_files/figure-html/fig-poisson-1.png" class="img-fluid figure-img" width="672">
</div>
</figure>
</div>
</div>
</div>
</section>
<section id="categorical-random-variable" class="level3" data-number="13.4.5">
<h3 data-number="13.4.5" class="anchored" data-anchor-id="categorical-random-variable"><span class="header-section-number">13.4.5</span> Categorical Random Variable</h3>
<p>We can create a custom discrete probability distribution by enumerating the probability of each event in the sample space. For example, the PMF for the roll of a fair die is</p>
<p><span id="eq-categorical-pmf"><span class="math display">\[
p(x) =
\begin{cases}
\frac{1}{6} &amp; \text{if } x = 1\\
\frac{1}{6} &amp; \text{if } x = 2\\
\frac{1}{6} &amp; \text{if } x = 3\\
\frac{1}{6} &amp; \text{if } x = 4\\
\frac{1}{6} &amp; \text{if } x = 5\\
\frac{1}{6} &amp; \text{if } x = 6
\end{cases}
\tag{13.9}\]</span></span></p>
<p>This PMF is visualized in <a href="#fig-die" class="quarto-xref">Figure&nbsp;<span>13.1</span></a>. We can sample from this PMF with</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p>We can also sample with probabilities that differ for each event:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">sample</span>(</span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="st">"rain"</span>, <span class="st">"sunshine"</span>), </span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="at">size =</span> <span class="dv">1</span>, </span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>)</span>
<span id="cb15-5"><a href="#cb15-5"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sunshine"</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color:#1696d2;">Exercise 2</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Sample 1,000 observations from a Poisson distribution with <span class="math inline">\(\lambda = 20\)</span>.</li>
<li>Sample 1,000 observations from a normal distribution with <span class="math inline">\(\mu = 20\)</span> and <span class="math inline">\(\sigma = \sqrt{20}\)</span>.</li>
<li>Visualize and compare both distribution.</li>
</ol>
</div>
</div>
<p>When <span class="math inline">\(\lambda\)</span> is sufficiently large, the normal distribution is a reasonable approximation of the poisson distribution.</p>
</section>
</section>
<section id="continuous-random-variables" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="continuous-random-variables"><span class="header-section-number">13.5</span> Continuous Random Variables</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Probability Density Function (PDF)
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <strong>probability density function</strong> is a non-negative, integrable function for each real value <span class="math inline">\(x\)</span> that shows the relative probability of values of <span class="math inline">\(x\)</span> for an absolutely continuous random variable <span class="math inline">\(X\)</span>.</p>
<p>We note PDF with <span class="math inline">\(f_X(x)\)</span>.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Cumulative Distribution Function (CDF)
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <strong>cumulative distribution function (cdf)</strong> shows the probability of a random variable <span class="math inline">\(X\)</span> taking on any value less than or equal to <span class="math inline">\(x\)</span>.</p>
<p>We note CDF with <span class="math inline">\(F_X(x) = P(X \le x)\)</span></p>
</div>
</div>
<p>Here is the PDF for a <strong>standard normal random variable:</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">n =</span> <span class="dv">101</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-5"><a href="#cb17-5"></a>    <span class="at">title =</span> <span class="st">"PDF for a standard normal random variable"</span>,</span>
<span id="cb17-6"><a href="#cb17-6"></a>    <span class="at">subtitle =</span> <span class="st">"Observed data in black and theoretical distribution in red"</span>,</span>
<span id="cb17-7"><a href="#cb17-7"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb17-8"><a href="#cb17-8"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="14_simulation-and-sampling_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If we integrate the entire function we get the CDF.</p>
<p><strong>Cumulative Density Function (CDF):</strong> A function of a random variable <span class="math inline">\(X\)</span> that returns the probability that the value <span class="math inline">\(X &lt; x\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> pnorm, <span class="at">n =</span> <span class="dv">101</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-5"><a href="#cb18-5"></a>    <span class="at">title =</span> <span class="st">"CDF for a standard normal random variable"</span>,</span>
<span id="cb18-6"><a href="#cb18-6"></a>    <span class="at">subtitle =</span> <span class="st">"Observed data in black and theoretical distribution in red"</span>,</span>
<span id="cb18-7"><a href="#cb18-7"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>  ) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="14_simulation-and-sampling_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="uniform-distribution" class="level3" data-number="13.5.1">
<h3 data-number="13.5.1" class="anchored" data-anchor-id="uniform-distribution"><span class="header-section-number">13.5.1</span> Uniform Distribution</h3>
<p><a href="https://en.wikipedia.org/wiki/Continuous_uniform_distribution">Uniform random variables</a> have equal probability for every value in the sample space. The distribution has two parameters: minimum and maximum. A standard uniform random has minimum = 0 and maximum = 1.</p>
<p>We show that a random variable is uniform distributed with</p>
<p><span id="eq-uniform"><span class="math display">\[
X \sim U(a, b)
\tag{13.10}\]</span></span></p>
<p>The PDF of a uniform random variable is</p>
<p><span id="eq-uniform-pdf"><span class="math display">\[
f(x) =
\begin{cases}
\frac{1}{b - a} &amp; \text{if } x \in [a, b] \\
0 &amp; \text{otherwise}
\end{cases}
\tag{13.11}\]</span></span></p>
<p>Standard uniform random variables are useful for generating other random processes and imputation.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">set.seed</span>(<span class="dv">20200904</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="fu">tibble</span>(</span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="at">x =</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb19-5"><a href="#cb19-5"></a>) <span class="sc">|&gt;</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(density))) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dunif, <span class="at">n =</span> <span class="dv">101</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb19-9"><a href="#cb19-9"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-10"><a href="#cb19-10"></a>    <span class="at">title =</span> <span class="st">"1,000 samples of a standard uniform RV"</span>,</span>
<span id="cb19-11"><a href="#cb19-11"></a>    <span class="at">subtitle =</span> <span class="st">"Observed data in black and theoretical distribution in red"</span>,    </span>
<span id="cb19-12"><a href="#cb19-12"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb19-13"><a href="#cb19-13"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="14_simulation-and-sampling_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="normal-distribution" class="level3" data-number="13.5.2">
<h3 data-number="13.5.2" class="anchored" data-anchor-id="normal-distribution"><span class="header-section-number">13.5.2</span> Normal Distribution</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Normal_distribution">normal distribution</a> is the backbone of statistical inference because of the <a href="https://en.wikipedia.org/wiki/Central_limit_theorem">central limit theorem</a>.</p>
<p>We show that a random variable is normally distributed with</p>
<p><span id="eq-normal"><span class="math display">\[
X \sim N(\mu, \sigma)
\tag{13.12}\]</span></span></p>
<p>The PDF of a normally distributed random variable is</p>
<p><span id="eq-normal-pdf"><span class="math display">\[
f(x) = \frac{1}{\sigma\sqrt{2\pi}} \exp\left[-\frac{1}{2}\left(\frac{x - \mu}{\sigma}\right) ^ 2\right]
\tag{13.13}\]</span></span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Fundamental Probability Formula for Intervals
</div>
</div>
<div class="callout-body-container callout-body">
<p>The probability that an absolutely continuous random variable takes on any specific value is always zero because the sample space is uncountable. Accordingly, we express the probability of observing events within a region for absolutely continuous random variables.</p>
<p>If <span class="math inline">\(X\)</span> has a PDF and <span class="math inline">\(a &lt; b\)</span>, then</p>
<p><span id="eq-fundamental-probability"><span class="math display">\[
P(a \le X \le b) = P(a \le X &lt; b) = P(a &lt; X \le b) = P(a &lt; X &lt; b) = \int_a^bf(x)dx = F_X(b) - F_X(a)
\tag{13.14}\]</span></span></p>
</div>
</div>
<p>The last portion of this inequality is fundamental to working with continuous probability distributions and is the backbone of much of any intro to statistics course. For example, the probability, <span class="math inline">\(P(X &lt; 0)\)</span> is represented by the blue region below.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>)) <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">n =</span> <span class="dv">101</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="fu">geom_area</span>(<span class="at">stat =</span> <span class="st">"function"</span>, <span class="at">fun =</span> dnorm, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>  <span class="fu">labs</span>(</span>
<span id="cb20-6"><a href="#cb20-6"></a>    <span class="at">title =</span> <span class="st">"PDF for a standard normal random variable"</span>,</span>
<span id="cb20-7"><a href="#cb20-7"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb20-8"><a href="#cb20-8"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="14_simulation-and-sampling_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color:#1696d2;">Exercise 3</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://en.wikipedia.org/wiki/Student%27s_t-distribution">Student’s t-distribution</a> and the normal distribution are closely related.</p>
<ol type="1">
<li>Use <code>pnorm()</code> to calculate <span class="math inline">\(P(X &lt; -1)\)</span> for a standard normal distribution.</li>
<li>Use <code>pt()</code> to calculate <span class="math inline">\(P(X &lt; -1)\)</span> for Student’s t-distribution with <code>df = 10</code>.</li>
<li>Use <code>pt()</code> to calculate <span class="math inline">\(P(X &lt; -1)\)</span> for Student’s t-distribution with <code>df = 100</code>.</li>
</ol>
</div>
</div>
<p>Observe how the normal distribution becomes a better approximation for Student’s t-distribution when the degrees of freedom increases.</p>
</section>
<section id="exponential-distribution" class="level3" data-number="13.5.3">
<h3 data-number="13.5.3" class="anchored" data-anchor-id="exponential-distribution"><span class="header-section-number">13.5.3</span> Exponential Distribution</h3>
<p>An <a href="https://en.wikipedia.org/wiki/Exponential_distribution">exponential random variable</a> is the wait time between events for a poisson random variable. It is useful for modeling wait time. For example, an exponential distribution can be used to model the wait time between arrivals in an emergency room between 1AM and 2AM. It has one parameter: rate (<span class="math inline">\(\lambda\)</span>).</p>
<p>We show that a random variable is exponentially distributed with</p>
<p><span id="eq-exponential"><span class="math display">\[
X \sim Exp(\lambda)
\tag{13.15}\]</span></span></p>
<p>The PDF of an exponential random variable is</p>
<p><span id="eq-exponential-pdf"><span class="math display">\[
f(x) = \lambda\exp(-\lambda x)
\tag{13.16}\]</span></span></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">tibble</span>(</span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="at">x =</span> <span class="fu">rexp</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb21-3"><a href="#cb21-3"></a>) <span class="sc">|&gt;</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dexp, <span class="at">n =</span> <span class="dv">101</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">rate =</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb21-7"><a href="#cb21-7"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-8"><a href="#cb21-8"></a>    <span class="at">title =</span> <span class="st">"1,000 samples of an exponential RV"</span>,</span>
<span id="cb21-9"><a href="#cb21-9"></a>    <span class="at">subtitle =</span> <span class="st">"Observed data in black and theoretical distribution in red"</span>,    </span>
<span id="cb21-10"><a href="#cb21-10"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb21-11"><a href="#cb21-11"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="14_simulation-and-sampling_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="other-distributions" class="level3" data-number="13.5.4">
<h3 data-number="13.5.4" class="anchored" data-anchor-id="other-distributions"><span class="header-section-number">13.5.4</span> Other Distributions</h3>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Geometric_distribution"><strong>Geometric RV:</strong></a> Number of Bernoulli trials up to and including the <span class="math inline">\(1^{st}\)</span> event</li>
<li><a href="https://en.wikipedia.org/wiki/Negative_binomial_distribution"><strong>Negative Binomial RV:</strong></a> Number of Bernoulli trials up to and including the <span class="math inline">\(r^{th}\)</span> event</li>
<li><a href="https://en.wikipedia.org/wiki/Gamma_distribution"><strong>Gamma RV:</strong></a> Time until the <span class="math inline">\(\alpha\)</span> person arrives</li>
</ul>
</section>
</section>
<section id="parametric-density-estimation" class="level2" data-number="13.6">
<h2 data-number="13.6" class="anchored" data-anchor-id="parametric-density-estimation"><span class="header-section-number">13.6</span> Parametric Density Estimation</h2>
<p>A key exercise in statistics is selecting a probability distribution to represent data and then learning the parameters of probability distributions from the data. The process is often called <strong>model fitting</strong>.</p>
<p>We are focused on parametric density estimation. Later, we will focus on nonparameteric density estimation. This section will focus on frequentist inference of population parameters from observed data. Later, we will adopt a Bayesian approach to inference.</p>
<section id="maximum-likelihood-estimation" class="level3" data-number="13.6.1">
<h3 data-number="13.6.1" class="anchored" data-anchor-id="maximum-likelihood-estimation"><span class="header-section-number">13.6.1</span> Maximum Likelihood Estimation</h3>
<p>All of the probability distributions we have observed have a finite number of parameters. Maximum likelihood estimation is a common method for estimating these parameters.</p>
<p>The general process is</p>
<ol type="1">
<li>Pick the probability distribution that fits the observed data.</li>
<li>Identify the finite number of parameters associated with the probability distribution.</li>
<li>Calculate the parameters that maximize the probability of the observed data.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Likelihood
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(\vec{x}\)</span> be observed data and <span class="math inline">\(\theta\)</span> be a parameter or parameters from a chosen probability distribution. The <strong>likelihood</strong> is the joint probability of the observed data conditional on values of the parameters.</p>
<p>The likelihood of discrete data is</p>
<p><span id="eq-discrete-likelihood"><span class="math display">\[
L(\theta) = P(\vec{x}|\theta) = \Pi_{i = 1}^n p(x_i|\theta)
\tag{13.17}\]</span></span></p>
<p>The likelihood of continuous data is</p>
<p><span id="eq-continuous-likelihood"><span class="math display">\[
L(\theta) = P(\vec{x}|\theta) = \Pi_{i = 1}^n f(x_i|\theta)
\tag{13.18}\]</span></span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Maximum Likelihood Estimation
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Maximum likelihood estimation</strong> is a process for estimating parameters for a given distribution that maximizes the log likelihood.</p>
<p>In other words, MLEs find the estimated parameters that maximize the probability of observing the observed set of data.</p>
</div>
</div>
<p>We won’t unpack how to derive the maximum likelihood estimators<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> but it is easy to look up most MLEs.</p>
<section id="binomial-distribution-mles" class="level4">
<h4 class="anchored" data-anchor-id="binomial-distribution-mles">Binomial distribution MLEs</h4>
<p>Suppose we have a sample of data <span class="math inline">\(x_1, ..., x_m\)</span>. If the number of trials <span class="math inline">\(n\)</span> is already known, then <span class="math inline">\(p\)</span> is the only parameter for the binomial distribution that needs to be estimated. The MLE for <span class="math inline">\(p\)</span> is <span class="math inline">\(\hat{p} = \frac{\sum_{i = 1}^n x_i}{mn}\)</span>.</p>
<p>Suppose we observe the following vector of observed data. Next, we calculate <span class="math inline">\(\hat{p}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">set.seed</span>(<span class="dv">20230909</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a>x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">8</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.3</span>)</span>
<span id="cb22-3"><a href="#cb22-3"></a></span>
<span id="cb22-4"><a href="#cb22-4"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 3 6 3 4 3 3 2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>mle_binom <span class="ot">&lt;-</span> <span class="fu">sum</span>(x) <span class="sc">/</span> (<span class="dv">10</span> <span class="sc">*</span> <span class="dv">8</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a>mle_binom</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.35</code></pre>
</div>
</div>
</section>
<section id="normal-distribution-mles" class="level4">
<h4 class="anchored" data-anchor-id="normal-distribution-mles">Normal distribution MLEs</h4>
<p><span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are the parameters of a normal distribution. The MLEs for a normal distribution are <span class="math inline">\(\hat\mu = \frac{1}{n}\sum_{i = 1}^n x_i = \bar{x}\)</span> and <span class="math inline">\(s^2 = \frac{1}{n} \sum_{i = 1}^n (x_i - \bar{x})^2\)</span>.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>Suppose we observe the following vector of observed data. Next, we calculate <span class="math inline">\(\hat\mu = \frac{1}{n}\sum_{i = 1}^n x_i\)</span> and <span class="math inline">\(\hat\sigma^2 = \frac{1}{n}\sum_{i = 1}^n (x_i - \bar{x})^2\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">set.seed</span>(<span class="dv">20230909</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>mean_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb27-2"><a href="#cb27-2"></a></span>
<span id="cb27-3"><a href="#cb27-3"></a>mean_hat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02825125</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>sigma2_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>((x <span class="sc">-</span> <span class="fu">mean</span>(x)) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a></span>
<span id="cb29-3"><a href="#cb29-3"></a>sigma2_hat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8119682</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> x) <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(x, <span class="at">y =</span> <span class="fu">after_stat</span>(density))) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> mean_hat, <span class="at">sd =</span> <span class="fu">sqrt</span>(sigma2_hat)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="14_simulation-and-sampling_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exponential-distribution-mles" class="level4">
<h4 class="anchored" data-anchor-id="exponential-distribution-mles">Exponential distribution MLEs</h4>
<p><span class="math inline">\(\lambda\)</span> is the only parameter of an exponential distribution. The MLE for an exponential distribution is <span class="math inline">\(\hat\lambda = \frac{1}{\bar{x}}\)</span>.</p>
<p>Suppose we observe the following vector of observed data. Next, we calculate <span class="math inline">\(\frac{1}{\bar{x}}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">set.seed</span>(<span class="dv">20230909</span>)</span>
<span id="cb33-2"><a href="#cb33-2"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="at">rate =</span> <span class="dv">10</span>)</span>
<span id="cb33-3"><a href="#cb33-3"></a></span>
<span id="cb33-4"><a href="#cb33-4"></a>mle_exp <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(x)</span>
<span id="cb33-5"><a href="#cb33-5"></a></span>
<span id="cb33-6"><a href="#cb33-6"></a>mle_exp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.58221</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">tibble</span>(<span class="at">x =</span> x) <span class="sc">|&gt;</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(x, <span class="at">y =</span> <span class="fu">after_stat</span>(density))) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dexp, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">rate =</span> mle_exp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="14_simulation-and-sampling_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color:#1696d2;">Exercise 4</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Create the vector in the code chunk below:</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="fl">30970.787</span>, <span class="fl">10901.544</span>, <span class="fl">15070.015</span>, <span class="fl">10445.772</span>, <span class="fl">8972.258</span>, </span>
<span id="cb37-3"><a href="#cb37-3"></a>  <span class="fl">15759.614</span>, <span class="fl">13341.328</span>, <span class="fl">18498.858</span>, <span class="fl">134462.066</span>, <span class="fl">17498.930</span>, </span>
<span id="cb37-4"><a href="#cb37-4"></a>  <span class="fl">7112.306</span>, <span class="fl">27336.795</span>, <span class="fl">75526.381</span>, <span class="fl">110123.606</span>, <span class="fl">32910.618</span>, </span>
<span id="cb37-5"><a href="#cb37-5"></a>  <span class="fl">16764.452</span>, <span class="fl">21244.380</span>, <span class="fl">18952.455</span>, <span class="fl">954373.470</span>, <span class="fl">4219.635</span>,</span>
<span id="cb37-6"><a href="#cb37-6"></a>  <span class="fl">7078.766</span>, <span class="fl">27657.996</span>, <span class="fl">18337.097</span>, <span class="fl">14566.525</span>, <span class="fl">14220.000</span>, </span>
<span id="cb37-7"><a href="#cb37-7"></a>  <span class="fl">21457.202</span>, <span class="fl">9322.311</span>, <span class="fl">26018.018</span>, <span class="fl">96325.728</span>, <span class="fl">26780.329</span>, </span>
<span id="cb37-8"><a href="#cb37-8"></a>  <span class="fl">25833.356</span>, <span class="fl">10719.360</span>, <span class="fl">8642.935</span>, <span class="fl">29302.623</span>, <span class="fl">10517.174</span>,</span>
<span id="cb37-9"><a href="#cb37-9"></a>  <span class="fl">33831.547</span>, <span class="fl">339077.456</span>, <span class="fl">5805.707</span>, <span class="fl">141505.710</span>, <span class="fl">28168.790</span>, </span>
<span id="cb37-10"><a href="#cb37-10"></a>  <span class="fl">10446.378</span>, <span class="fl">4993.349</span>, <span class="fl">27502.949</span>, <span class="fl">35519.162</span>, <span class="fl">45761.505</span>, </span>
<span id="cb37-11"><a href="#cb37-11"></a>  <span class="fl">26163.096</span>, <span class="fl">72163.668</span>, <span class="fl">15515.435</span>, <span class="fl">69396.895</span>, <span class="fl">84972.590</span>, </span>
<span id="cb37-12"><a href="#cb37-12"></a>  <span class="fl">67248.460</span>, <span class="fl">26966.374</span>, <span class="fl">24624.339</span>, <span class="fl">4779.110</span>, <span class="fl">23330.279</span>,</span>
<span id="cb37-13"><a href="#cb37-13"></a>  <span class="fl">196311.913</span>, <span class="fl">20517.739</span>, <span class="fl">80257.587</span>, <span class="fl">32108.466</span>, <span class="fl">9735.061</span>, </span>
<span id="cb37-14"><a href="#cb37-14"></a>  <span class="fl">20502.579</span>, <span class="fl">2544.004</span>, <span class="fl">165909.040</span>, <span class="fl">20949.512</span>, <span class="fl">16643.695</span>, </span>
<span id="cb37-15"><a href="#cb37-15"></a>  <span class="fl">30267.741</span>, <span class="fl">8359.024</span>, <span class="fl">13355.154</span>, <span class="fl">8425.988</span>, <span class="fl">4491.550</span>,</span>
<span id="cb37-16"><a href="#cb37-16"></a>  <span class="fl">32071.872</span>, <span class="fl">61648.149</span>, <span class="fl">75074.135</span>, <span class="fl">62842.985</span>, <span class="fl">26040.648</span>, </span>
<span id="cb37-17"><a href="#cb37-17"></a>  <span class="fl">68733.979</span>, <span class="fl">63368.710</span>, <span class="fl">11157.211</span>, <span class="fl">5782.610</span>, <span class="fl">3629.674</span>, </span>
<span id="cb37-18"><a href="#cb37-18"></a>  <span class="fl">44399.230</span>, <span class="fl">2852.381</span>, <span class="fl">8200.453</span>, <span class="fl">41249.003</span>, <span class="fl">15006.791</span>,</span>
<span id="cb37-19"><a href="#cb37-19"></a>  <span class="fl">808974.653</span>, <span class="fl">30705.915</span>, <span class="fl">6341.954</span>, <span class="fl">28208.144</span>, <span class="fl">5409.821</span>,</span>
<span id="cb37-20"><a href="#cb37-20"></a>  <span class="fl">54566.805</span>, <span class="fl">10894.864</span>, <span class="fl">4583.550</span>, <span class="fl">31110.875</span>, <span class="fl">43474.872</span>, </span>
<span id="cb37-21"><a href="#cb37-21"></a>  <span class="fl">69059.161</span>, <span class="fl">33054.574</span>, <span class="fl">8789.910</span>, <span class="fl">218887.477</span>, <span class="fl">11051.292</span>, </span>
<span id="cb37-22"><a href="#cb37-22"></a>  <span class="fl">3366.743</span>, <span class="fl">63853.329</span>, <span class="fl">68756.561</span>, <span class="fl">48031.259</span>, <span class="fl">11707.191</span>,</span>
<span id="cb37-23"><a href="#cb37-23"></a>  <span class="fl">26593.634</span>, <span class="fl">8868.942</span>, <span class="fl">19225.309</span>, <span class="fl">27704.670</span>, <span class="fl">10666.549</span>, </span>
<span id="cb37-24"><a href="#cb37-24"></a>  <span class="fl">47151.963</span>, <span class="fl">20343.604</span>, <span class="fl">123932.502</span>, <span class="fl">33030.986</span>, <span class="fl">5412.023</span>, </span>
<span id="cb37-25"><a href="#cb37-25"></a>  <span class="fl">23540.382</span>, <span class="fl">9894.513</span>, <span class="fl">52742.541</span>, <span class="fl">21397.990</span>, <span class="fl">25100.143</span>,</span>
<span id="cb37-26"><a href="#cb37-26"></a>  <span class="fl">23757.882</span>, <span class="fl">48347.300</span>, <span class="fl">4325.134</span>, <span class="fl">23816.776</span>, <span class="fl">11907.656</span>, </span>
<span id="cb37-27"><a href="#cb37-27"></a>  <span class="fl">24179.849</span>, <span class="fl">25967.574</span>, <span class="fl">7531.294</span>, <span class="fl">15131.240</span>, <span class="fl">21595.781</span>, </span>
<span id="cb37-28"><a href="#cb37-28"></a>  <span class="fl">40473.936</span>, <span class="fl">35390.849</span>, <span class="fl">4060.563</span>, <span class="fl">55334.157</span>, <span class="fl">37058.771</span>, </span>
<span id="cb37-29"><a href="#cb37-29"></a>  <span class="fl">34050.456</span>, <span class="fl">17351.500</span>, <span class="fl">7453.829</span>, <span class="fl">48131.565</span>, <span class="fl">10576.746</span>,</span>
<span id="cb37-30"><a href="#cb37-30"></a>  <span class="fl">26450.754</span>, <span class="fl">33592.986</span>, <span class="fl">21425.018</span>, <span class="fl">34729.337</span>, <span class="fl">77370.078</span>, </span>
<span id="cb37-31"><a href="#cb37-31"></a>  <span class="fl">5819.325</span>, <span class="fl">9067.356</span>, <span class="fl">19829.998</span>, <span class="fl">20120.706</span>, <span class="fl">3637.042</span>, </span>
<span id="cb37-32"><a href="#cb37-32"></a>  <span class="fl">44812.638</span>, <span class="fl">22930.229</span>, <span class="fl">29683.776</span>, <span class="fl">76366.822</span>, <span class="fl">15464.594</span>, </span>
<span id="cb37-33"><a href="#cb37-33"></a>  <span class="fl">1273.101</span>, <span class="fl">53036.266</span>, <span class="fl">2846.294</span>, <span class="fl">114076.200</span>, <span class="fl">14492.680</span>, </span>
<span id="cb37-34"><a href="#cb37-34"></a>  <span class="fl">55071.554</span>, <span class="fl">31597.849</span>, <span class="fl">199724.125</span>, <span class="fl">52332.510</span>, <span class="fl">98411.129</span>, </span>
<span id="cb37-35"><a href="#cb37-35"></a>  <span class="fl">43108.506</span>, <span class="fl">6580.620</span>, <span class="fl">12833.836</span>, <span class="fl">8846.348</span>, <span class="fl">7599.796</span>, </span>
<span id="cb37-36"><a href="#cb37-36"></a>  <span class="fl">6952.447</span>, <span class="fl">30022.143</span>, <span class="fl">24829.739</span>, <span class="fl">40784.581</span>, <span class="fl">8997.219</span>,</span>
<span id="cb37-37"><a href="#cb37-37"></a>  <span class="fl">3786.354</span>, <span class="fl">11515.298</span>, <span class="fl">116515.617</span>, <span class="fl">137873.967</span>, <span class="fl">3282.185</span>,</span>
<span id="cb37-38"><a href="#cb37-38"></a>  <span class="fl">107886.676</span>, <span class="fl">13184.850</span>, <span class="fl">51083.235</span>, <span class="fl">2907.886</span>, <span class="fl">51827.538</span>, </span>
<span id="cb37-39"><a href="#cb37-39"></a>  <span class="fl">37564.196</span>, <span class="fl">23196.399</span>, <span class="fl">20169.037</span>, <span class="fl">9020.364</span>, <span class="fl">11118.250</span>, </span>
<span id="cb37-40"><a href="#cb37-40"></a>  <span class="fl">56930.060</span>, <span class="fl">11657.302</span>, <span class="fl">84642.584</span>, <span class="fl">44948.450</span>, <span class="fl">16610.166</span>, </span>
<span id="cb37-41"><a href="#cb37-41"></a>  <span class="fl">5509.231</span>, <span class="fl">4770.262</span>, <span class="fl">15614.233</span>, <span class="fl">5993.999</span>, <span class="fl">22628.114</span></span>
<span id="cb37-42"><a href="#cb37-42"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol start="2" type="1">
<li>Visualize the data with a relative frequency histogram.</li>
<li>Calculate the MLEs for a normal distribution and add a normal distribution to the visualization in red.</li>
<li>Calculate the MLEs for a log-normal distribution and add a log-normal distribution to the visualization in blue.</li>
</ol>
</div>
</div>
</section>
</section>
</section>
<section id="multivariate-random-variables" class="level2" data-number="13.7">
<h2 data-number="13.7" class="anchored" data-anchor-id="multivariate-random-variables"><span class="header-section-number">13.7</span> Multivariate Random Variables</h2>
<p>We’ve explored univariate or marginal distributions thus far. Next, we will focus on multivariate distributions.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Multivariate Distribution
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <strong>multivariate distribution</strong> is a probability distribution that shows the probability (discrete) or relative probability (continuous) of more than one random variable.</p>
<p>Multivariate distributions require describing characteristics of random variables and the relationships between random variables.</p>
</div>
</div>
<section id="multivariate-normal-distribution" class="level3" data-number="13.7.1">
<h3 data-number="13.7.1" class="anchored" data-anchor-id="multivariate-normal-distribution"><span class="header-section-number">13.7.1</span> Multivariate Normal Distribution</h3>
<p>The <a href="https://en.wikipedia.org/wiki/Multivariate_normal_distribution">multivariate normal distribution</a> is a higher-dimensional version of the normal distribution.</p>
<p>Instead of a single mean and a single variance, the <span class="math inline">\(k\)</span>-dimensional multivariate normal distribution has a vector of means of length <span class="math inline">\(k\)</span> and a <span class="math inline">\(k\)</span>-by-<span class="math inline">\(k\)</span> variance-covariance matrix<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. The vector describes the central tendencies of each dimension of the multivariate distribution and the matrix describe the variance of the distributions and relationships between the distributions.</p>
<p>We show that a random vector is multivariate normally distributed with</p>
<p><span id="eq-multivariate-normal"><span class="math display">\[
\vec{X} \sim \mathcal{N}(\vec\mu, \boldsymbol\Sigma)
\tag{13.19}\]</span></span></p>
<p>The PDF of a multivariate normally distributed random variable is</p>
<p><span id="eq-multivariate-normal-pdf"><span class="math display">\[
f(x) = (2\pi)^{-k/2}det(\boldsymbol\Sigma)^{-1/2}\exp\left(-\frac{1}{2}(\vec{x} - \vec\mu)^T\boldsymbol\Sigma^{-1}(\vec{x} - \vec\mu)\right)
\tag{13.20}\]</span></span></p>
<p>Functions for working with multi-variate normal distributions from <code>library(MASS)</code>. <a href="#fig-mvnorm" class="quarto-xref">Figure&nbsp;<span>13.4</span></a> shows three different random samples from 2-dimensional multivariate normal distributions.</p>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>Sigma1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.8</span>, </span>
<span id="cb38-2"><a href="#cb38-2"></a>                   <span class="fl">0.8</span>, <span class="dv">1</span>),</span>
<span id="cb38-3"><a href="#cb38-3"></a>                 <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb38-4"><a href="#cb38-4"></a>                 <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-5"><a href="#cb38-5"></a>  </span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">Sigma =</span> Sigma1) <span class="sc">|&gt;</span></span>
<span id="cb38-7"><a href="#cb38-7"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb38-8"><a href="#cb38-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(V1, V2)) <span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if
`.name_repair` is omitted as of tibble 2.0.0.
ℹ Using compatibility `.name_repair`.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>Sigma2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.2</span>, </span>
<span id="cb40-2"><a href="#cb40-2"></a>                   <span class="fl">0.2</span>, <span class="dv">1</span>),</span>
<span id="cb40-3"><a href="#cb40-3"></a>                 <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb40-4"><a href="#cb40-4"></a>                 <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-5"><a href="#cb40-5"></a></span>
<span id="cb40-6"><a href="#cb40-6"></a><span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">Sigma =</span> Sigma2) <span class="sc">|&gt;</span></span>
<span id="cb40-7"><a href="#cb40-7"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-8"><a href="#cb40-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(V1, V2)) <span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb40-10"><a href="#cb40-10"></a></span>
<span id="cb40-11"><a href="#cb40-11"></a>Sigma3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.8</span>, </span>
<span id="cb40-12"><a href="#cb40-12"></a>                   <span class="sc">-</span><span class="fl">0.8</span>, <span class="dv">1</span>),</span>
<span id="cb40-13"><a href="#cb40-13"></a>                 <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb40-14"><a href="#cb40-14"></a>                 <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-15"><a href="#cb40-15"></a></span>
<span id="cb40-16"><a href="#cb40-16"></a><span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">Sigma =</span> Sigma3) <span class="sc">|&gt;</span></span>
<span id="cb40-17"><a href="#cb40-17"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-18"><a href="#cb40-18"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(V1, V2)) <span class="sc">+</span></span>
<span id="cb40-19"><a href="#cb40-19"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-mvnorm" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-fig" id="fig-mvnorm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13.4: Samples from Multivariate Normal Distributions
</figcaption>
<div aria-describedby="fig-mvnorm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mvnorm" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-mvnorm-1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-fig" id="fig-mvnorm-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Strong Positive Covariance
</figcaption>
<div aria-describedby="fig-mvnorm-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="14_simulation-and-sampling_files/figure-html/fig-mvnorm-1.png" class="img-fluid figure-img" data-ref-parent="fig-mvnorm" width="672">
</div>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mvnorm" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-mvnorm-2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-fig" id="fig-mvnorm-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Weak Covariance
</figcaption>
<div aria-describedby="fig-mvnorm-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="14_simulation-and-sampling_files/figure-html/fig-mvnorm-2.png" class="img-fluid figure-img" data-ref-parent="fig-mvnorm" width="672">
</div>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mvnorm" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-mvnorm-3" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-fig" id="fig-mvnorm-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Strong Negative Covariance
</figcaption>
<div aria-describedby="fig-mvnorm-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="14_simulation-and-sampling_files/figure-html/fig-mvnorm-3.png" class="img-fluid figure-img" data-ref-parent="fig-mvnorm" width="672">
</div>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
</section>
</section>
<section id="monte-carlo-methods" class="level2" data-number="13.8">
<h2 data-number="13.8" class="anchored" data-anchor-id="monte-carlo-methods"><span class="header-section-number">13.8</span> Monte Carlo Methods</h2>
<p>Simulation methods, including Monte Carlo simulation, are used for policy analysis:</p>
<ul>
<li>FiveThirtyEight and the New York Times use Monte Carlo simulation to predict the outcomes of elections.</li>
<li>The Social Security Administration uses microsimulation to evaluate the distributional impact of Social Security reforms.</li>
<li>The Census Bureau uses simulation to understand the impact of statistical disclosure control on released data.</li>
<li>Econometricians and statisticians use Monte Carlo simulation to demonstrate the properties of estimators.</li>
</ul>
<p>We can make probabilistic statements about common continuous random variables because their PDFs are integrable or at least easy enough to approximate with lookup tables. We can make probabilistic statements about common discrete random variables with summation.</p>
<p>But we often want to make probabilistic statements about uncommon or complex probability distributions. Maybe the probability distribution of the random variable doesn’t have a tractable integral (i.e.&nbsp;the area under the curve can’t practically be computed). Or maybe there are too many potential outcomes (e.g.&nbsp;rays of light emitting from a light bulb in the Marble Science video linked at the top).</p>
<p><strong>Monte Carlo:</strong> A Monte Carlo method estimates a deterministic quantity using stochastic (random) sampling.</p>
<p><strong>Monte Carlo but easier this time:</strong> A Monte Carlo method takes hundreds or thousands of independent samples from a random variable or variables and then approximates fixed population quantities with summaries of those draws. The quantities could be population parameters like a population mean or probabilities.</p>
<p>Monte Carlo methods have three major applications:</p>
<ol type="1">
<li><strong>Sampling</strong> – Monte Carlo simulation allows for sampling from complex probability distributions. The samples can be used to model real-world events (queues), to model outcomes with uncertain model inputs (election modeling), to generate fake data with known parameters to evaluate statistical methods (model selection when assumptions fail), and to draw from the posteriors of Bayesian models.</li>
<li><strong>Numerical integration</strong> – Integration, as noted above, is important to calculating probabilities and ultimately calculating quantities like expected value or the intervals. Monte Carlo methods can approximate multidimensional integrals that will never be directly solved by computers or simplify estimating probabilities when there are uncountably many potential outcomes (Solitaire).</li>
<li><strong>Optimization</strong> – Monte Carlo methods can be used for complex optimization. We will not focus on optimization.</li>
</ol>
<p>Let’s explore some examples:</p>
<section id="example-1-coin-tossing" class="level3" data-number="13.8.1">
<h3 data-number="13.8.1" class="anchored" data-anchor-id="example-1-coin-tossing"><span class="header-section-number">13.8.1</span> Example 1: Coin Tossing</h3>
<p>We can calculate the proportion of tosses of a fair coin that we expect to turn up heads by finding the expected value of the binomial distribution and dividing by the number of tosses. But suppose we can’t… Or maybe we wish to confirm our calculations with simulations…</p>
<p>Let’s try repeated sampling from a binomial distribution to approximate this process:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co">#' Count the proportion of n tosses that turn up heads</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="co">#'</span></span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="co">#' @param n An integer for the number of tosses</span></span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="co">#'</span></span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="co">#' @return The proportion of n tosses that turn up heads</span></span>
<span id="cb41-6"><a href="#cb41-6"></a><span class="co">#' </span></span>
<span id="cb41-7"><a href="#cb41-7"></a>count_heads <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb41-8"><a href="#cb41-8"></a>  </span>
<span id="cb41-9"><a href="#cb41-9"></a>  <span class="co"># toss the fair coin n times</span></span>
<span id="cb41-10"><a href="#cb41-10"></a>  coin_tosses <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb41-11"><a href="#cb41-11"></a>    </span>
<span id="cb41-12"><a href="#cb41-12"></a>  coin_tosses <span class="ot">&lt;-</span> <span class="fu">if_else</span>(coin_tosses <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"heads"</span>, <span class="st">"tails"</span>)</span>
<span id="cb41-13"><a href="#cb41-13"></a>  </span>
<span id="cb41-14"><a href="#cb41-14"></a>  <span class="co"># calculate the proportion of heads</span></span>
<span id="cb41-15"><a href="#cb41-15"></a>  prop_heads <span class="ot">&lt;-</span> <span class="fu">mean</span>(coin_tosses <span class="sc">==</span> <span class="st">"heads"</span>)</span>
<span id="cb41-16"><a href="#cb41-16"></a>  </span>
<span id="cb41-17"><a href="#cb41-17"></a>  <span class="fu">return</span>(prop_heads)</span>
<span id="cb41-18"><a href="#cb41-18"></a>  </span>
<span id="cb41-19"><a href="#cb41-19"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s toss the coin ten times.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="fu">count_heads</span>(<span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3</code></pre>
</div>
</div>
<p>Ok, we got 0.3, which we know isn’t close to the expected proportion of 0.5. What if we toss the coin 1 million times.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">set.seed</span>(<span class="dv">20</span>)</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="fu">count_heads</span>(<span class="at">n =</span> <span class="dv">1000000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.499872</code></pre>
</div>
</div>
<p>Ok, that’s more like it.</p>
<p><span class="math display">\[\cdot\cdot\cdot\]</span></p>
<p>Monte Carlo simulation works because of the <strong>law of large numbers</strong>. The law of large numbers states that the probability that the average of trials differs from the expected value converges to zero as the number of trials goes to infinity.</p>
<p>Monte Carlo simulation basically repeats the ideas behind frequentist inferential statistics. If we can’t measure every unit in a population then we can sample a representative population and estimate parameters about that population.</p>
<p>The keys to Monte Carlo simulation are <strong>randomness</strong> and independent and identically distributed sampling (<strong>i.i.d.</strong>).</p>
</section>
<section id="example-2-bootstrap-sampling" class="level3" data-number="13.8.2">
<h3 data-number="13.8.2" class="anchored" data-anchor-id="example-2-bootstrap-sampling"><span class="header-section-number">13.8.2</span> Example 2: Bootstrap Sampling</h3>
<p>On average, a bootstrap sample includes about 63% of the observations from the data that are sampled. This means that an individual bootstrap sample excludes 37% of the observations from the source data!</p>
<p>So if we bootstrap sample from a vector of length 100, then <span class="math inline">\(\frac{63}{100}\)</span> values will end up in the bootstrap sample on average and <span class="math inline">\(\frac{37}{100}\)</span> of the values will be repeats on average.</p>
<p>We can explore this fact empirically with Monte Carlo simulation using repeated samples from a categorical distribution. We will use <code>sample()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="co">#' Calculate the proportion of unique values from a vector of integers included </span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="co">#' in a bootstrap sample</span></span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="co">#'</span></span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="co">#' @param integers A vector of integers</span></span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="co">#'</span></span>
<span id="cb46-6"><a href="#cb46-6"></a><span class="co">#' @return The proportion of integers included in the bootstrap sample</span></span>
<span id="cb46-7"><a href="#cb46-7"></a><span class="co">#' </span></span>
<span id="cb46-8"><a href="#cb46-8"></a>count_uniques <span class="ot">&lt;-</span> <span class="cf">function</span>(integers) {</span>
<span id="cb46-9"><a href="#cb46-9"></a>  </span>
<span id="cb46-10"><a href="#cb46-10"></a>  <span class="co"># generate a bootstrap sample</span></span>
<span id="cb46-11"><a href="#cb46-11"></a>  samples <span class="ot">&lt;-</span> <span class="fu">sample</span>(integers, <span class="at">size =</span> <span class="fu">length</span>(integers), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-12"><a href="#cb46-12"></a>  </span>
<span id="cb46-13"><a href="#cb46-13"></a>  <span class="co"># calculate the proportion of unique values from the original vector</span></span>
<span id="cb46-14"><a href="#cb46-14"></a>  prop_unique <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(samples)) <span class="sc">/</span> <span class="fu">length</span>(integers)</span>
<span id="cb46-15"><a href="#cb46-15"></a>  </span>
<span id="cb46-16"><a href="#cb46-16"></a>  <span class="fu">return</span>(prop_unique)</span>
<span id="cb46-17"><a href="#cb46-17"></a>  </span>
<span id="cb46-18"><a href="#cb46-18"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s bootstrap sample 100,000 times.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># pre-allocate the output vector for efficient computation</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>prop_unique <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"numeric"</span>, <span class="at">length =</span> <span class="dv">100000</span>)</span>
<span id="cb47-3"><a href="#cb47-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(prop_unique)) {</span>
<span id="cb47-4"><a href="#cb47-4"></a>  </span>
<span id="cb47-5"><a href="#cb47-5"></a>  prop_unique[i] <span class="ot">&lt;-</span> <span class="fu">count_uniques</span>(<span class="at">integers =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb47-6"><a href="#cb47-6"></a>  </span>
<span id="cb47-7"><a href="#cb47-7"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, calculate the mean proportion and estimate the expected value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">mean</span>(prop_unique)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6337935</code></pre>
</div>
</div>
<p>We can also calculate a 95% confidence interval using the bootstrap samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">quantile</span>(prop_unique, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 2.5% 97.5% 
 0.57  0.69 </code></pre>
</div>
</div>
</section>
<section id="example-3-pi" class="level3" data-number="13.8.3">
<h3 data-number="13.8.3" class="anchored" data-anchor-id="example-3-pi"><span class="header-section-number">13.8.3</span> Example 3: <span class="math inline">\(\pi\)</span></h3>
<p>Consider one of the examples from <a href="https://www.youtube.com/watch?v=7ESK5SaP-bc">Marble Science: Monte Carlo Simulation</a>. Imagine we don’t know <span class="math inline">\(\pi\)</span> but we know that the equation for the area of a square is <span class="math inline">\(r ^ 2\)</span> and the equation for the area of a circle is <span class="math inline">\(\pi r ^ 2\)</span>. If we know the ratio of the areas of the circle and the square, then we can solve for <span class="math inline">\(\pi\)</span>.</p>
<p><span id="eq-pi"><span class="math display">\[
\frac{\text{Area of Cirle}}{\text{Area of Square}} = \frac{\pi r ^ 2}{r ^ 2} = \pi
\tag{13.21}\]</span></span></p>
<p>This is simply solved with Monte Carlo simulation. Randomly sample a bivariate uniform random variables and count how frequently the values are inside of the square or inside the circle.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="fu">expand_grid</span>(</span>
<span id="cb52-2"><a href="#cb52-2"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="fl">0.1</span>),</span>
<span id="cb52-3"><a href="#cb52-3"></a>  <span class="at">y =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="fl">0.1</span>)</span>
<span id="cb52-4"><a href="#cb52-4"></a>) <span class="sc">|&gt;</span></span>
<span id="cb52-5"><a href="#cb52-5"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb52-6"><a href="#cb52-6"></a>  ggforce<span class="sc">::</span><span class="fu">geom_circle</span>(<span class="fu">aes</span>(<span class="at">x0 =</span> <span class="dv">2</span>, <span class="at">y0 =</span> <span class="dv">1</span>, <span class="at">r =</span> <span class="dv">1</span>), <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">1</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="dv">1</span>), <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb52-8"><a href="#cb52-8"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> <span class="dv">0</span>, <span class="at">xmax =</span> <span class="dv">3</span>, <span class="at">ymin =</span> <span class="dv">0</span>, <span class="at">ymax =</span> <span class="dv">2</span>), <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb52-9"><a href="#cb52-9"></a>  <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in ggforce::geom_circle(aes(x0 = 2, y0 = 1, r = 1), fill = "blue", : All aesthetics have length 1, but the data has 861 rows.
ℹ Did you mean to use `annotate()`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_rect(aes(xmin = 0, xmax = 1, ymin = 0, ymax = 1), fill = "red", : All aesthetics have length 1, but the data has 861 rows.
ℹ Did you mean to use `annotate()`?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_rect(aes(xmin = 0, xmax = 3, ymin = 0, ymax = 2), fill = NA, : All aesthetics have length 1, but the data has 861 rows.
ℹ Did you mean to use `annotate()`?</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="14_simulation-and-sampling_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>number_of_samples <span class="ot">&lt;-</span> <span class="dv">2000000</span></span>
<span id="cb56-2"><a href="#cb56-2"></a></span>
<span id="cb56-3"><a href="#cb56-3"></a><span class="co"># sample points in a rectangle with x in [0, 3] and y in [0, 2]</span></span>
<span id="cb56-4"><a href="#cb56-4"></a><span class="fu">set.seed</span>(<span class="dv">20210907</span>)</span>
<span id="cb56-5"><a href="#cb56-5"></a>samples <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb56-6"><a href="#cb56-6"></a>  <span class="at">x =</span> <span class="fu">runif</span>(number_of_samples, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">3</span>),</span>
<span id="cb56-7"><a href="#cb56-7"></a>  <span class="at">y =</span> <span class="fu">runif</span>(number_of_samples, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">2</span>)</span>
<span id="cb56-8"><a href="#cb56-8"></a>)</span>
<span id="cb56-9"><a href="#cb56-9"></a></span>
<span id="cb56-10"><a href="#cb56-10"></a><span class="co"># calculate if (x, y) is in the circle, the square, or neither</span></span>
<span id="cb56-11"><a href="#cb56-11"></a>samples <span class="ot">&lt;-</span> samples <span class="sc">|&gt;</span></span>
<span id="cb56-12"><a href="#cb56-12"></a>  <span class="fu">mutate</span>(</span>
<span id="cb56-13"><a href="#cb56-13"></a>    <span class="at">in_square =</span> <span class="fu">between</span>(x, <span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">&amp;</span> <span class="fu">between</span>(y, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb56-14"><a href="#cb56-14"></a>    <span class="at">in_circle =</span> (x <span class="sc">-</span> <span class="dv">2</span>) <span class="sc">^</span> <span class="dv">2</span> <span class="sc">+</span> (y <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">^</span> <span class="dv">2</span> <span class="sc">&lt;</span> <span class="dv">1</span></span>
<span id="cb56-15"><a href="#cb56-15"></a>  ) </span>
<span id="cb56-16"><a href="#cb56-16"></a></span>
<span id="cb56-17"><a href="#cb56-17"></a><span class="co"># calculate the proportion of samples in each shape</span></span>
<span id="cb56-18"><a href="#cb56-18"></a>prop_in_shapes <span class="ot">&lt;-</span> samples <span class="sc">|&gt;</span></span>
<span id="cb56-19"><a href="#cb56-19"></a>  <span class="fu">summarize</span>(</span>
<span id="cb56-20"><a href="#cb56-20"></a>    <span class="at">prop_in_square =</span> <span class="fu">mean</span>(in_square), </span>
<span id="cb56-21"><a href="#cb56-21"></a>    <span class="at">prop_in_circle =</span> <span class="fu">mean</span>(in_circle)</span>
<span id="cb56-22"><a href="#cb56-22"></a>  ) </span>
<span id="cb56-23"><a href="#cb56-23"></a></span>
<span id="cb56-24"><a href="#cb56-24"></a><span class="co"># calculate the ratio</span></span>
<span id="cb56-25"><a href="#cb56-25"></a>prop_in_shapes <span class="sc">|&gt;</span></span>
<span id="cb56-26"><a href="#cb56-26"></a>  <span class="fu">mutate</span>(prop_in_circle <span class="sc">/</span> prop_in_square) <span class="sc">|&gt;</span></span>
<span id="cb56-27"><a href="#cb56-27"></a>  <span class="fu">print</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  prop_in_square prop_in_circle `prop_in_circle/prop_in_square`
           &lt;dbl&gt;          &lt;dbl&gt;                           &lt;dbl&gt;
1          0.166          0.524                            3.15</code></pre>
</div>
</div>
<p>The answer approximates <span class="math inline">\(\pi\)</span>!</p>
</section>
<section id="example-4-simple-linear-regression" class="level3" data-number="13.8.4">
<h3 data-number="13.8.4" class="anchored" data-anchor-id="example-4-simple-linear-regression"><span class="header-section-number">13.8.4</span> Example 4: Simple Linear Regression</h3>
<p>The goal of statistical inference is to use data, statistics, and assumptions to infer parameters and probabilities about a population. Typically we engage in point estimation and interval estimation.</p>
<p>Sometimes it is useful to reverse this process to understand and confirm the properties of estimators. That means starting with known population parameters, simulating hundreds or thousands of samples from that population, and then observing point estimates and interval estimates over those samples.</p>
<section id="linear-regression-assumptions" class="level4">
<h4 class="anchored" data-anchor-id="linear-regression-assumptions">Linear Regression Assumptions</h4>
<ol type="1">
<li>The population model is of the linear form <span class="math inline">\(y = \beta_0 + \beta_1 x + \epsilon\)</span></li>
<li>The estimation data come from a random sample or experiment</li>
<li><span class="math inline">\(\epsilon_i \sim N(0, \sigma^2)\)</span> independently and identically distributed (i.i.d.)</li>
<li><span class="math inline">\(x\)</span> has variance and there is no perfect collinearity in <span class="math inline">\(x\)</span></li>
</ol>
</section>
<section id="statistics-1" class="level4">
<h4 class="anchored" data-anchor-id="statistics-1">Statistics</h4>
<p>If we have one sample of data, we can estimate points and intervals with the following estimators:</p>
<p>The residual standard error is</p>
<p><span id="eq-residual-se"><span class="math display">\[
\hat\sigma = \frac{\sum e_i^2}{(n - 2)}
\tag{13.22}\]</span></span></p>
<p>The estimate of the slope is</p>
<p><span id="eq-slope"><span class="math display">\[
\hat\beta_1 = \frac{\sum(x_i - \bar{x})(y_i - \bar{y})}{\sum(x_i - \bar{x})^2}
\tag{13.23}\]</span></span></p>
<p>The standard error of the estimate of the slope, which can be used to calculate t-statistics and confidence intervals, is</p>
<p><span id="eq-slope-se"><span class="math display">\[
\hat{SE}(\hat\beta_1) = \sqrt\frac{\hat\sigma^2}{\sum(x_i -\bar{x})^2}
\tag{13.24}\]</span></span></p>
<p>The estimate of the intercept term is</p>
<p><span id="eq-intercept"><span class="math display">\[
\hat\beta_0 = \bar{y} - \hat\beta_1\bar{x}
\tag{13.25}\]</span></span></p>
<p>The standard error of the intercept is</p>
<p><span id="eq-intercept-se"><span class="math display">\[
\hat{SE}(\hat{\beta_0}) = \sqrt{\hat\sigma^2\left[\frac{1}{n} + \frac{\bar{x}^2}{\sum(x_i - \bar{x})^2}\right]}
\tag{13.26}\]</span></span></p>
</section>
<section id="monte-carlo-simulation" class="level4">
<h4 class="anchored" data-anchor-id="monte-carlo-simulation">Monte Carlo Simulation</h4>
<p>Consider a simple linear regression model with the following population model:</p>
<p><span class="math display">\[y = 5 + 15x + \epsilon\]</span></p>
<p>We can calculate the above statistics over repeated sampling and confirm their asymptotic properties with Monte Carlo simulation.</p>
<p>First, create 1,000 random samples from the population.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">set.seed</span>(<span class="dv">20210906</span>)</span>
<span id="cb58-2"><a href="#cb58-2"></a></span>
<span id="cb58-3"><a href="#cb58-3"></a>data <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb58-4"><a href="#cb58-4"></a>  <span class="at">.x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>,</span>
<span id="cb58-5"><a href="#cb58-5"></a>  <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">tibble</span>(</span>
<span id="cb58-6"><a href="#cb58-6"></a>    <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">2</span>),</span>
<span id="cb58-7"><a href="#cb58-7"></a>    <span class="at">epsilon =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">10</span>),</span>
<span id="cb58-8"><a href="#cb58-8"></a>    <span class="at">y =</span> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">15</span> <span class="sc">*</span> x <span class="sc">+</span> epsilon</span>
<span id="cb58-9"><a href="#cb58-9"></a>  )</span>
<span id="cb58-10"><a href="#cb58-10"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, estimate a simple linear regression model for each draw of the population. This step includes calculating <span class="math inline">\(\hat\sigma\)</span>, <span class="math inline">\(\hat\beta_1\)</span>, <span class="math inline">\(\hat\beta_0\)</span>, <span class="math inline">\(\hat{SE}(\hat\beta_1)\)</span>, and <span class="math inline">\(\hat{SE}(\hat\beta_0)\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>estimated_models <span class="ot">&lt;-</span> <span class="fu">map</span>(</span>
<span id="cb59-2"><a href="#cb59-2"></a>  <span class="at">.x =</span> data,</span>
<span id="cb59-3"><a href="#cb59-3"></a>  <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> .x)</span>
<span id="cb59-4"><a href="#cb59-4"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we extract the coefficients and confidence intervals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>coefficients <span class="ot">&lt;-</span> <span class="fu">map_df</span>(</span>
<span id="cb60-2"><a href="#cb60-2"></a>  <span class="at">.x =</span> estimated_models,</span>
<span id="cb60-3"><a href="#cb60-3"></a>  <span class="at">.f =</span> tidy,</span>
<span id="cb60-4"><a href="#cb60-4"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span></span>
<span id="cb60-5"><a href="#cb60-5"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s look at estimates of the residual standard error. The center of the distribution closely matches the population standard deviation of the error term.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>model_metrics <span class="ot">&lt;-</span> <span class="fu">map_df</span>(</span>
<span id="cb61-2"><a href="#cb61-2"></a>  <span class="at">.x =</span> estimated_models,</span>
<span id="cb61-3"><a href="#cb61-3"></a>  <span class="at">.f =</span> glance</span>
<span id="cb61-4"><a href="#cb61-4"></a>) </span>
<span id="cb61-5"><a href="#cb61-5"></a></span>
<span id="cb61-6"><a href="#cb61-6"></a>model_metrics <span class="sc">|&gt;</span></span>
<span id="cb61-7"><a href="#cb61-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(sigma)) <span class="sc">+</span></span>
<span id="cb61-8"><a href="#cb61-8"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb61-9"><a href="#cb61-9"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Plot of the estimated residual standard errors"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="14_simulation-and-sampling_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s plot the coefficients. The centers approximately match the population intercept of 5 and slope of 15.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>coefficients <span class="sc">|&gt;</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(estimate)) <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>term, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Coefficients estimates across 10,000 samples"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="14_simulation-and-sampling_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The standard deviation of the coefficients also matches the standard errors.</p>
<p><span class="math display">\[\hat{SE}(\hat\beta_1) = \sqrt\frac{\hat\sigma^2}{\sum(x_i -\bar{x})^2} = \sqrt\frac{10^2}{40,000} = 0.05\]</span></p>
<p><span class="math display">\[\hat{SE}(\hat{\beta_0}) = \sqrt{\hat\sigma^2\left[\frac{1}{n} + \frac{\bar{x}^2}{\sum(x_i - \bar{x})^2}\right]} = \sqrt{10^2\left[\frac{1}{10,000} + 0\right]} = 0.1\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>coefficients <span class="sc">|&gt;</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>  <span class="fu">group_by</span>(term) <span class="sc">|&gt;</span></span>
<span id="cb65-3"><a href="#cb65-3"></a>  <span class="fu">summarize</span>(</span>
<span id="cb65-4"><a href="#cb65-4"></a>    <span class="fu">mean</span>(estimate), </span>
<span id="cb65-5"><a href="#cb65-5"></a>    <span class="fu">sd</span>(estimate)</span>
<span id="cb65-6"><a href="#cb65-6"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  term        `mean(estimate)` `sd(estimate)`
  &lt;chr&gt;                  &lt;dbl&gt;          &lt;dbl&gt;
1 (Intercept)             5.00         0.100 
2 x                      15.0          0.0482</code></pre>
</div>
</div>
<p>Let’s look at how often the true parameter is inside the 95% confidence interval. It’s close although not exactly 95%.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>coefficients <span class="sc">|&gt;</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"x"</span>) <span class="sc">|&gt;</span></span>
<span id="cb67-3"><a href="#cb67-3"></a>  <span class="fu">summarize</span>(<span class="at">ci_contain_beta =</span> <span class="fu">mean</span>(conf.low <span class="sc">&lt;=</span> <span class="dv">15</span> <span class="sc">&amp;</span> conf.high <span class="sc">&gt;=</span> <span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  ci_contain_beta
            &lt;dbl&gt;
1           0.959</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>coefficients <span class="sc">|&gt;</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"(Intercept)"</span>) <span class="sc">|&gt;</span></span>
<span id="cb69-3"><a href="#cb69-3"></a>  <span class="fu">summarize</span>(<span class="at">ci_contain_beta =</span> <span class="fu">mean</span>(conf.low <span class="sc">&lt;=</span> <span class="dv">5</span> <span class="sc">&amp;</span> conf.high <span class="sc">&gt;=</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  ci_contain_beta
            &lt;dbl&gt;
1            0.95</code></pre>
</div>
</div>
</section>
</section>
<section id="example-5-queuing-example" class="level3" data-number="13.8.5">
<h3 data-number="13.8.5" class="anchored" data-anchor-id="example-5-queuing-example"><span class="header-section-number">13.8.5</span> Example 5: Queuing Example</h3>
<p>Suppose we have a queue at a Social Security field office. Let <span class="math inline">\(t\)</span> be time. When the office opens, <span class="math inline">\(t = 0\)</span> and the queue is empty.</p>
<p>Let, <span class="math inline">\(T_i\)</span> be the <strong>inter</strong>arrival time and <span class="math inline">\(T_i \sim exp(\lambda_1)\)</span></p>
<p>Let, <span class="math inline">\(S_i\)</span> be the service time time and <span class="math inline">\(S_I \sim exp(\lambda_2)\)</span></p>
<p>From these two random variables, we can calculate the arrival times, departure times, and wait times for each customer.</p>
<ul>
<li>The arrival times are the cumulative sum of the interarrival times.</li>
<li>The wait times are zero if a person arrives after the person before them and the difference between the prior person’s departure and the current person’s arrival otherwise.</li>
<li>The departure time is arrival time plus the wait time plus the service time.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="fu">set.seed</span>(<span class="dv">19920401</span>)</span>
<span id="cb71-2"><a href="#cb71-2"></a>queue <span class="ot">&lt;-</span> <span class="fu">generate_queue</span>(<span class="at">t =</span> <span class="dv">100</span>, <span class="at">lambda =</span> <span class="dv">1</span>, <span class="at">mu =</span> <span class="dv">1</span>)</span>
<span id="cb71-3"><a href="#cb71-3"></a></span>
<span id="cb71-4"><a href="#cb71-4"></a>queue</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 5
   interarrival_time arrival_time service_time wait_time departure_time
               &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;          &lt;dbl&gt;
 1             0.467        0.467       5.80        0              6.27
 2             1.97         2.43        0.0892      3.83           6.36
 3             2.70         5.13        1.26        1.22           7.61
 4             0.335        5.47        4.85        2.14          12.5 
 5             0.372        5.84        1.89        6.62          14.3 
 6             1.72         7.56        0.507       6.78          14.9 
 7             2.28         9.84        0.932       5.01          15.8 
 8             0.339       10.2         1.18        5.61          17.0 
 9             2.54        12.7         1.42        4.25          18.4 
10             0.572       13.3         0.157       5.10          18.5 
# ℹ 90 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>flow <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb73-2"><a href="#cb73-2"></a>  <span class="at">time =</span> <span class="fu">c</span>(queue<span class="sc">$</span>arrival_time, queue<span class="sc">$</span>departure_time),</span>
<span id="cb73-3"><a href="#cb73-3"></a>  <span class="at">type =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"arrival"</span>, <span class="fu">length</span>(queue<span class="sc">$</span>arrival_time)), </span>
<span id="cb73-4"><a href="#cb73-4"></a>           <span class="fu">rep</span>(<span class="st">"departure"</span>, <span class="fu">length</span>(queue<span class="sc">$</span>departure_time))), </span>
<span id="cb73-5"><a href="#cb73-5"></a>  <span class="at">change =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(queue<span class="sc">$</span>arrival_time)), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fu">length</span>(queue<span class="sc">$</span>departure_time))),</span>
<span id="cb73-6"><a href="#cb73-6"></a>) <span class="sc">|&gt;</span></span>
<span id="cb73-7"><a href="#cb73-7"></a>  <span class="fu">arrange</span>(time) <span class="sc">|&gt;</span> </span>
<span id="cb73-8"><a href="#cb73-8"></a>  <span class="fu">filter</span>(time <span class="sc">&lt;</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-9"><a href="#cb73-9"></a>  <span class="fu">mutate</span>(<span class="at">queue =</span> <span class="fu">cumsum</span>(change) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb73-10"><a href="#cb73-10"></a></span>
<span id="cb73-11"><a href="#cb73-11"></a>flow <span class="sc">|&gt;</span></span>
<span id="cb73-12"><a href="#cb73-12"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(time, queue)) <span class="sc">+</span></span>
<span id="cb73-13"><a href="#cb73-13"></a>  <span class="fu">geom_step</span>() <span class="sc">+</span></span>
<span id="cb73-14"><a href="#cb73-14"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Simulated queue at the Social Security office"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="14_simulation-and-sampling_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This is interesting, but it’s still only one draw from a Monte Carlo simulation. What if we are interested in the distribution of wait times for the fifth customer?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="co">#' Generate wait times at the queue</span></span>
<span id="cb74-2"><a href="#cb74-2"></a><span class="co">#'</span></span>
<span id="cb74-3"><a href="#cb74-3"></a><span class="co">#' @param person_number An integer for the person of interest</span></span>
<span id="cb74-4"><a href="#cb74-4"></a><span class="co">#' @param iterations An integer for the number of Monte Carlo iterations</span></span>
<span id="cb74-5"><a href="#cb74-5"></a><span class="co">#' @param t A t for the maximum time</span></span>
<span id="cb74-6"><a href="#cb74-6"></a><span class="co">#'</span></span>
<span id="cb74-7"><a href="#cb74-7"></a><span class="co">#' @return A vector of wait times</span></span>
<span id="cb74-8"><a href="#cb74-8"></a><span class="co">#' </span></span>
<span id="cb74-9"><a href="#cb74-9"></a>generate_waits <span class="ot">&lt;-</span> <span class="cf">function</span>(person_number, iterations, t) {</span>
<span id="cb74-10"><a href="#cb74-10"></a>  </span>
<span id="cb74-11"><a href="#cb74-11"></a>  wait_time <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"numeric"</span>, <span class="at">length =</span> iterations)</span>
<span id="cb74-12"><a href="#cb74-12"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(wait_time)) {</span>
<span id="cb74-13"><a href="#cb74-13"></a>    </span>
<span id="cb74-14"><a href="#cb74-14"></a>    wait_time[i] <span class="ot">&lt;-</span> <span class="fu">generate_queue</span>(<span class="at">t =</span> t, <span class="at">lambda =</span> <span class="dv">1</span>, <span class="at">mu =</span> <span class="dv">1</span>)<span class="sc">$</span>wait_time[person_number]</span>
<span id="cb74-15"><a href="#cb74-15"></a>    </span>
<span id="cb74-16"><a href="#cb74-16"></a>  }</span>
<span id="cb74-17"><a href="#cb74-17"></a>  </span>
<span id="cb74-18"><a href="#cb74-18"></a>  <span class="fu">return</span>(wait_time)</span>
<span id="cb74-19"><a href="#cb74-19"></a>  </span>
<span id="cb74-20"><a href="#cb74-20"></a>}</span>
<span id="cb74-21"><a href="#cb74-21"></a></span>
<span id="cb74-22"><a href="#cb74-22"></a><span class="fu">set.seed</span>(<span class="dv">20200908</span>)</span>
<span id="cb74-23"><a href="#cb74-23"></a>wait_time <span class="ot">&lt;-</span> <span class="fu">generate_waits</span>(<span class="at">person_number =</span> <span class="dv">5</span>, <span class="at">iterations =</span> <span class="dv">10000</span>, <span class="at">t =</span> <span class="dv">50</span>)</span>
<span id="cb74-24"><a href="#cb74-24"></a></span>
<span id="cb74-25"><a href="#cb74-25"></a><span class="fu">mean</span>(wait_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.464371</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="fu">quantile</span>(wait_time, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5%       50%     97.5% 
0.0000000 0.9222193 5.8742015 </code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color:#1696d2;">Exercise 5</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Create a Monte Carlo simulation of an unfair coin toss where <code>p = 0.6</code>.</li>
</ol>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color:#1696d2;">Exercise 6</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Suppose we have three independent normally-distributed random variables.</p>
<p><span class="math display">\[X_1 \sim N(\mu = 0, \sigma = 1)\]</span></p>
<p><span class="math display">\[X_2 \sim N(\mu = 1, \sigma = 1)\]</span></p>
<p><span class="math display">\[X_3 \sim N(\mu = 2, \sigma = 1)\]</span></p>
<ol start="2" type="1">
<li>Use Monte Carlo simulation with 10,000 repetitions to estimate how often <span class="math inline">\(X_{i1} &lt; X_{i2} &lt; X_{i3}\)</span>.</li>
</ol>
</div>
</div>
</section>
<section id="more-examples-of-monte-carlo-simulation" class="level3" data-number="13.8.6">
<h3 data-number="13.8.6" class="anchored" data-anchor-id="more-examples-of-monte-carlo-simulation"><span class="header-section-number">13.8.6</span> More examples of Monte Carlo simulation</h3>
<ul>
<li><a href="https://projects.fivethirtyeight.com/2020-election-forecast/">fivethirtyeight 2020 election forecast</a> use</li>
<li><a href="https://www.census.gov/topics/research/stat-research/expertise/sim-stat-modeling.html">U.S. Census Bureau simulation of data collection operations</a></li>
</ul>
<section id="markov-chain-monte-carlo" class="level4">
<h4 class="anchored" data-anchor-id="markov-chain-monte-carlo">Markov Chain Monte Carlo</h4>
<p>Bayesian statisticians estimate posterior distributions of parameters that are combinations of prior distributions and sampling distributions. Outside of special cases, posterior distributions are difficult to identify. Accordingly, most Bayesian estimation uses an extension of Monte Carlo simulation called Markov Chain Monte Carlo or MCMC.</p>
</section>
</section>
<section id="one-final-note" class="level3" data-number="13.8.7">
<h3 data-number="13.8.7" class="anchored" data-anchor-id="one-final-note"><span class="header-section-number">13.8.7</span> One Final Note</h3>
<p>Monte Carlo simulations likely underestimate uncertainty. Monte Carlo simulations only capture aleatoric uncertainty and they don’t capture epistemic uncertainty.</p>
<p><strong>Aleatoric uncertainty:</strong> Uncertainty due to probabilistic variety</p>
<p><strong>Epistemic uncertainty:</strong> Uncertainty due to a lack of knowledge</p>
<p>In other words, Monte Carlo simulations estimates assume the model is correct, which is almost certainly never fully true. Be transparent. Be humble.</p>
</section>
</section>
<section id="sampling-from-observed-data" class="level2" data-number="13.9">
<h2 data-number="13.9" class="anchored" data-anchor-id="sampling-from-observed-data"><span class="header-section-number">13.9</span> Sampling from Observed Data</h2>
<p>Until now, we’ve only discussed sampling from closed-form theoretical distributions. We also called this process simulation. There are many applications where we may want to sample from observed data.</p>
<p>We can break these methods into two general approaches:</p>
<ol type="1">
<li>Sampling</li>
<li>Resampling</li>
</ol>
<section id="sampling" class="level3" data-number="13.9.1">
<h3 data-number="13.9.1" class="anchored" data-anchor-id="sampling"><span class="header-section-number">13.9.1</span> Sampling</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Sampling
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Sampling</strong> is the process of selecting a subset of data. <strong>Probability sampling</strong> is the process of selecting a sample when the selection uses randomization.</p>
</div>
</div>
<p>Sampling has many applications:</p>
<ul>
<li>Reducing costs for the collection of data</li>
<li>Implementing machine learning algorithms</li>
<li>Resampling</li>
</ul>
</section>
<section id="resampling" class="level3" data-number="13.9.2">
<h3 data-number="13.9.2" class="anchored" data-anchor-id="resampling"><span class="header-section-number">13.9.2</span> Resampling</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Resampling
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Resampling</strong> is the process of repeatedly sampling from observed data to approximate the generation of new data.</p>
</div>
</div>
<p>There are at least three popular resampling methods:</p>
<ol type="1">
<li><strong>Cross Validation:</strong> Partitioning the data and shuffling the partitions to understand the accuracy of predictive models.</li>
<li><strong>Bootstrap sampling:</strong> Repeated sampling with replacement to estimate sampling distributions from observed data.</li>
<li><strong>Jackknife:</strong> Leave-one-out sampling to estimate the bias and standard error of a statistic.</li>
</ol>
<p>We focused on cross-validation for machine learning and predictive modeling in data science for public policy. We will use this approach again for predictive modeling.</p>
<p>We will also learn about bootstrap sampling when we discuss nonparametric statistics.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-casella2002" class="csl-entry" role="listitem">
Casella, George, and Roger L. Berger. 2002. <em>Statistical Inference</em>. 2nd ed. Australia ; Pacific Grove, CA: Thomson Learning.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p><span class="citation" data-cites="casella2002">(<a href="references.html#ref-casella2002" role="doc-biblioref">Casella and Berger 2002</a>)</span> offers a robust introduction to deriving maximum likelihood estimators.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Note that the MLE for variance is biased.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Correlation may be more familiar than covariance. Sample correlation is standardized sample covariance. <span class="math inline">\(Corr(\vec{x}, \vec{y}) = \frac{Cov(\vec{x}, \vec{y})}{S_{\vec{x}}S_{\vec{y}}}\)</span>. Correlation is also between -1 and 1 inclusive. Covariance can take on any real value.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./13_web-scraping.html" class="pagination-link" aria-label="Web Scraping">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Web Scraping</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./15_microsimulation.html" class="pagination-link" aria-label="Microsimulation">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Microsimulation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>