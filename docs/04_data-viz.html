<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Data Science for Public Policy - 4&nbsp; Data Visualization with ggplot2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05_exploratory-data-analysis.html" rel="next">
<link href="./03_advanced-data-cleaning.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="www/styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01_intro-r.html">Basics</a></li><li class="breadcrumb-item"><a href="./04_data-viz.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Visualization with ggplot2</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science for Public Policy</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_intro-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to the tidyverse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_advanced-data-cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Advanced Data Cleaning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_data-viz.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Visualization with ggplot2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_exploratory-data-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Reproducible Research</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_reproducible-research-with-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Reproducible Research with Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_advanced-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Advanced Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_reproducible-research-with-git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Reproducible Research with Git and GitHub</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_advanced-git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Advanced Git and Github</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Programming</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Advanced R Programming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_apis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Web Application Programming Interfaces (Web APIs)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_web-scraping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Web Scraping</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_simulation-and-sampling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Simulation and Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_microsimulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Microsimulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_nonparametric-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Nonparametric Curve Fitting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_nonparametric-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Nonparametric Inference</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Supervised Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19_predictive-modeling-motivation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Predictive Modeling Motivation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20_predictive-modeling-concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Predictive Modeling Concepts and Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21_supervised-classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Classification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22_ensembling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Ensembling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23_regularization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Regularization</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Unsupervised Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./27_advanced-unsupervised-ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Mixture Distributions and Mixture Modeling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Other Topics</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#motivation" id="toc-motivation" class="nav-link active" data-scroll-target="#motivation"><span class="header-section-number">4.1</span> Motivation</a></li>
  <li><a href="#motivation-going-beyond-excel" id="toc-motivation-going-beyond-excel" class="nav-link" data-scroll-target="#motivation-going-beyond-excel"><span class="header-section-number">4.2</span> Motivation (going beyond Excel)</a></li>
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background"><span class="header-section-number">4.3</span> Background</a></li>
  <li><a href="#eight-ingredients-in-the-grammar-of-graphics" id="toc-eight-ingredients-in-the-grammar-of-graphics" class="nav-link" data-scroll-target="#eight-ingredients-in-the-grammar-of-graphics"><span class="header-section-number">4.4</span> Eight Ingredients in the Grammar of Graphics:</a>
  <ul class="collapse">
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">4.4.1</span> Data</a></li>
  <li><a href="#aesthetic-mappings" id="toc-aesthetic-mappings" class="nav-link" data-scroll-target="#aesthetic-mappings"><span class="header-section-number">4.4.2</span> Aesthetic Mappings:</a></li>
  <li><a href="#geometric-objects" id="toc-geometric-objects" class="nav-link" data-scroll-target="#geometric-objects"><span class="header-section-number">4.4.3</span> Geometric Objects:</a></li>
  <li><a href="#scales" id="toc-scales" class="nav-link" data-scroll-target="#scales"><span class="header-section-number">4.4.4</span> Scales:</a></li>
  <li><a href="#coordinate-systems" id="toc-coordinate-systems" class="nav-link" data-scroll-target="#coordinate-systems"><span class="header-section-number">4.4.5</span> Coordinate Systems:</a></li>
  <li><a href="#facets" id="toc-facets" class="nav-link" data-scroll-target="#facets"><span class="header-section-number">4.4.6</span> Facets:</a></li>
  <li><a href="#statistical-transformations" id="toc-statistical-transformations" class="nav-link" data-scroll-target="#statistical-transformations"><span class="header-section-number">4.4.7</span> Statistical Transformations:</a></li>
  <li><a href="#themes" id="toc-themes" class="nav-link" data-scroll-target="#themes"><span class="header-section-number">4.4.8</span> Themes:</a></li>
  <li><a href="#layers-bonus" id="toc-layers-bonus" class="nav-link" data-scroll-target="#layers-bonus"><span class="header-section-number">4.4.9</span> Layers (bonus!):</a></li>
  <li><a href="#inheritances-bonus" id="toc-inheritances-bonus" class="nav-link" data-scroll-target="#inheritances-bonus"><span class="header-section-number">4.4.10</span> Inheritances (bonus!):</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">4.5</span> Summary</a>
  <ul class="collapse">
  <li><a href="#functions" id="toc-functions" class="nav-link" data-scroll-target="#functions"><span class="header-section-number">4.5.1</span> Functions</a></li>
  <li><a href="#theory" id="toc-theory" class="nav-link" data-scroll-target="#theory"><span class="header-section-number">4.5.2</span> Theory</a></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources"><span class="header-section-number">4.5.3</span> Resources</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Visualization with ggplot2</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    This chapter introduces ggplot2, the tidyverse’s wildly popular data visualization package.
  </div>
</div>

</header>

<section id="motivation" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="motivation"><span class="header-section-number">4.1</span> Motivation</h2>
<ol type="1">
<li>Data visualization is exploratory data analysis (EDA)</li>
<li>Data visualization is diagnosis and validation</li>
<li>Data visualization is communication</li>
</ol>
</section>
<section id="motivation-going-beyond-excel" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="motivation-going-beyond-excel"><span class="header-section-number">4.2</span> Motivation (going beyond Excel)</h2>
<ul>
<li>Flexibility</li>
<li>Reproducibility</li>
<li>Scalability</li>
<li>Relational data vs.&nbsp;positional data</li>
</ul>
</section>
<section id="background" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="background"><span class="header-section-number">4.3</span> Background</h2>
<ul>
<li>The toughest part of data visualization is data munging.</li>
<li>Data frames are the only appropriate input for <code>library(ggplot2)</code>.</li>
</ul>
<p>ggplot2 is an R package for data visualization that was developed during Hadley Wickham’s graduate studies at Iowa State University. ggplot2 is formalized in <em>A Layered Grammar of Graphics</em> <span class="citation" data-cites="layered-grammar">(<a href="references.html#ref-layered-grammar" role="doc-biblioref">Wickham 2010</a>)</span>.</p>
<p>The grammar of graphics, originally by Leland Wilkinson, is a theoretical framework that breaks all data visualizations into their component pieces. With the layered grammar of graphics, Wickham extends Wilkinson’s grammar of graphics and implements it in R. The cohesion is impressive, and the theory flows to the code which informs the data visualization process in a way not reflected in any other data viz tool.</p>
<p>There are <strong>eight</strong> main ingredients to the grammar of graphics. We will work our way through the ingredients with many hands-on examples.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color:#1696d2;">Exercise 1</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Open your <code>.Rproj</code>.</li>
<li>Create a new <code>.R</code> script in your directory called <code>03_data-visualization.R</code>.</li>
<li><strong>Type</strong> (don’t copy &amp; paste) the following code below <code>library(tidyverse)</code> in <code>03_data-visualization.R</code>.</li>
</ol>
<pre><code>ggplot(data = storms) + 
  geom_point(mapping = aes(x = pressure, y = wind))</code></pre>
<ol start="4" type="1">
<li>Add a comment above the ggplot2 code that describes the plot we created.</li>
</ol>
</div>
</div>
</section>
<section id="eight-ingredients-in-the-grammar-of-graphics" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="eight-ingredients-in-the-grammar-of-graphics"><span class="header-section-number">4.4</span> Eight Ingredients in the Grammar of Graphics:</h2>
<section id="data" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="data"><span class="header-section-number">4.4.1</span> Data</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Data</strong> are the values represented in the visualization.</p>
</div>
</div>
<p><code>ggplot(data = )</code> or <code>data |&gt; ggplot()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>storms <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>  <span class="fu">select</span>(name, year, category, lat, long, wind, pressure) <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="fu">sample_n</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">category</th>
<th style="text-align: right;">lat</th>
<th style="text-align: right;">long</th>
<th style="text-align: right;">wind</th>
<th style="text-align: right;">pressure</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Felix</td>
<td style="text-align: right;">1989</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">19.1</td>
<td style="text-align: right;">-24.6</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">996</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fabian</td>
<td style="text-align: right;">1985</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">31.8</td>
<td style="text-align: right;">-47.0</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">994</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ingrid</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">19.6</td>
<td style="text-align: right;">-94.6</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">1002</td>
</tr>
<tr class="even">
<td style="text-align: left;">Frances</td>
<td style="text-align: right;">2004</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">27.4</td>
<td style="text-align: right;">-80.7</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">969</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Arthur</td>
<td style="text-align: right;">1984</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">16.9</td>
<td style="text-align: right;">-59.1</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">1012</td>
</tr>
<tr class="even">
<td style="text-align: left;">Omar</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">36.1</td>
<td style="text-align: right;">-69.3</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">1003</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marilyn</td>
<td style="text-align: right;">1995</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">27.2</td>
<td style="text-align: right;">-69.3</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">966</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arlene</td>
<td style="text-align: right;">1987</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">33.0</td>
<td style="text-align: right;">-63.6</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">1002</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Danielle</td>
<td style="text-align: right;">2004</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">16.0</td>
<td style="text-align: right;">-34.8</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">970</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hugo</td>
<td style="text-align: right;">1989</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">21.6</td>
<td style="text-align: right;">-68.0</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">964</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="aesthetic-mappings" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="aesthetic-mappings"><span class="header-section-number">4.4.2</span> Aesthetic Mappings:</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Aesthetic mappings</strong> are directions for how data are mapped in a plot in a way that we can perceive. Aesthetic mappings include linking variables to the x-position, y-position, color, fill, shape, transparency, and size.</p>
</div>
</div>
<p><code>aes(x = , y = , color = )</code></p>
<p><strong>X or Y</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Continuous Color or Fill</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Discrete Color or Fill</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Size</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Shape</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Others: transparency, line type</p>
</section>
<section id="geometric-objects" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="geometric-objects"><span class="header-section-number">4.4.3</span> Geometric Objects:</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Geometric objects</strong> are representations of the data, including points, lines, and polygons.</p>
</div>
</div>
<p><code>geom_bar()</code> or <code>geom_col()</code></p>
<p><em>Plots are often called their geometric object(s).</em></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><code>geom_line()</code></p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><code>geom_point()</code></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color:#1696d2;">Exercise 2</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Duplicate the code from Exercise 1. Add comments below the data visualization code that describes the argument or function that corresponds to each of the first three components of the grammar of graphics.</p></li>
<li><p>Inside <code>aes()</code>, add <code>color = category</code>. Run the code.</p></li>
<li><p>Replace <code>color = category</code> with <code>color = "green"</code>. Run the code. What changed? Is this unexpected?</p></li>
<li><p>Remove <code>color = "green"</code> from <code>aes()</code> and add it inside inside of <code>geom_point()</code> but outside of <code>aes()</code>. Run the code.</p></li>
<li><p>This is a little cluttered. Add <code>alpha = 0.2</code> inside <code>geom_point()</code> but outside of <code>aes()</code>.</p></li>
</ol>
</div>
</div>
<p>Aesthetic mappings like x and y almost always vary with the data. Aesthetic mappings like color, fill, shape, transparency, and size <em>can</em> vary with the data. But those arguments can also be added as styles that don’t vary with the data. If you include those arguments in <code>aes()</code>, they will show up in the legend (which can be annoying! and is also a sign that something should be changed!).</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color:#1696d2;">Exercise 3</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Create a new scatter plot using the <code>msleep</code> data set. Use <code>bodywt</code> on the x-axis and <code>sleep_total</code> on the y-axis.</li>
<li>The y-axis doesn’t contain zero. Below <code>geom_point()</code>, add <code>scale_y_continuous(limits = c(0, NA))</code>. Hint: add <code>+</code> after <code>geom_point()</code>.</li>
<li>The x-axis is clustered near zero. Add <code>scale_x_log10()</code> above <code>scale_y_continuous(limits = c(0, NA))</code>.</li>
</ol>
</div>
</div>
</section>
<section id="scales" class="level3" data-number="4.4.4">
<h3 data-number="4.4.4" class="anchored" data-anchor-id="scales"><span class="header-section-number">4.4.4</span> Scales:</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Scales</strong> turn data values, which are continuous, discrete, or categorical into aesthetic values. <code>scale_*_*()</code> functions control the specific behaviors of aesthetic mappings. This includes not only the x-axis and y-axis, but the ranges of sizes, types of shapes, and specific colors of aesthetics.</p>
</div>
</div>
<section id="before" class="level4">
<h4 class="anchored" data-anchor-id="before">Before</h4>
<p><code>scale_x_continuous()</code></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="after" class="level4">
<h4 class="anchored" data-anchor-id="after">After</h4>
<p><code>scale_x_reverse()</code></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="before-1" class="level4">
<h4 class="anchored" data-anchor-id="before-1">Before</h4>
<p><code>scale_size_continuous(breaks = c(25, 75, 125))</code></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="after-1" class="level4">
<h4 class="anchored" data-anchor-id="after-1">After</h4>
<p><code>scale_size_continuous(range = c(0.5, 20), breaks = c(25, 75, 125))</code></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color:#1696d2;">Exercise 4</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Type the following code in your script.</li>
</ol>
<pre><code>data &lt;- tibble(x = 1:10, y = 1:10)
ggplot(data = data) +
  geom_blank(mapping = aes(x = x, y = y))</code></pre>
<ol start="2" type="1">
<li><p>Add <code>coord_polar()</code> to your plot.</p></li>
<li><p>Add <code>labs(title = "Polar coordinate system")</code> to your plot.</p></li>
</ol>
</div>
</div>
</section>
</section>
<section id="coordinate-systems" class="level3" data-number="4.4.5">
<h3 data-number="4.4.5" class="anchored" data-anchor-id="coordinate-systems"><span class="header-section-number">4.4.5</span> Coordinate Systems:</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Coordinate systems</strong> map scaled geometric objects to the position of objects on the plane of a plot. The two most popular coordinate systems are the Cartesian coordinate system and the polar coordinate system.</p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><code>coord_polar()</code></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color:#1696d2;">Exercise 5</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Create a scatter plot of the <code>storms</code> data set with <code>pressure</code> on the x-axis and <code>wind</code> on the y-axis.</p></li>
<li><p>Add <code>facet_wrap(~ category)</code></p></li>
</ol>
</div>
</div>
</section>
<section id="facets" class="level3" data-number="4.4.6">
<h3 data-number="4.4.6" class="anchored" data-anchor-id="facets"><span class="header-section-number">4.4.6</span> Facets:</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Facets (optional)</strong> break data into meaningful subsets.</p>
</div>
</div>
<p><code>facet_wrap</code> and <code>facet_grid</code> are similar but have distinct functions. As the diagram below illustrates, <code>facet_wrap</code> organizes a 1 dimensional set of charts, but wraps the charts in two dimensions to preserve space. <code>facet_grid</code> organizes a set of charts in two dimensions. <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>You can see a helpful chart illustrating these differences <a href="https://ggplot2-book.org/facet">here</a>.</p>
<section id="facet-wrap" class="level4">
<h4 class="anchored" data-anchor-id="facet-wrap">Facet wrap</h4>
<p><code>facet_wrap(~ category)</code></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="facet-grid" class="level4">
<h4 class="anchored" data-anchor-id="facet-grid">Facet grid</h4>
<p><code>facet_grid(month ~ year)</code></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color:#1696d2;">Exercise 6</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Add the following code to your script. Submit it!</li>
</ol>
<pre><code>ggplot(storms) +
  geom_bar(mapping = aes(x = category))</code></pre>
</div>
</div>
</section>
</section>
<section id="statistical-transformations" class="level3" data-number="4.4.7">
<h3 data-number="4.4.7" class="anchored" data-anchor-id="statistical-transformations"><span class="header-section-number">4.4.7</span> Statistical Transformations:</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Statistical transformations (optional)</strong> transform the data, typically through summary statistics and functions, before aesthetic mapping.</p>
<p>Before transformations, each observation in data is represented by one geometric object (i.e.&nbsp;a scatter plot). After a transformation, a geometric object can represent more than one observation (i.e.&nbsp;a bar in a histogram).</p>
</div>
</div>
<p><strong>Note:</strong> <code>geom_bar()</code> performs statistical transformation. Use <code>geom_col()</code> to create a column chart with bars that encode individual observations in the data set.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color:#1696d2;">Exercise 7</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Duplicate Exercise 6.</p></li>
<li><p>Add <code>theme_minimal()</code> to the plot.</p></li>
</ol>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color:#1696d2;">Exercise 8</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Duplicate Exercise 6.</li>
<li>Run <code>install.packages("remotes")</code> and <code>remotes::install_github("UrbanInstitute/urbnthemes")</code> in the console.</li>
<li>In the lines preceding the chart add and run the following code:</li>
</ol>
<pre><code>library(urbnthemes)
set_urbn_defaults(style = "print")</code></pre>
<ol start="4" type="1">
<li><p>Run the code to make the chart.</p></li>
<li><p>Add <code>scale_y_continuous(expand = expansion(mult = c(0, 0.1)))</code> and rerun the code.</p></li>
</ol>
</div>
</div>
</section>
<section id="themes" class="level3" data-number="4.4.8">
<h3 data-number="4.4.8" class="anchored" data-anchor-id="themes"><span class="header-section-number">4.4.8</span> Themes:</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Themes</strong> control the visual style of plots with font types, font sizes, background colors, margins, and positioning.</p>
</div>
</div>
<section id="default-theme" class="level4">
<h4 class="anchored" data-anchor-id="default-theme">Default theme</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="fivethirtyeight-theme" class="level4">
<h4 class="anchored" data-anchor-id="fivethirtyeight-theme">fivethirtyeight theme</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="urbnthemes" class="level4">
<h4 class="anchored" data-anchor-id="urbnthemes">urbnthemes</h4>
<div class="cell">
<div class="cell-output-display">
<p><img src="04_data-viz_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color:#1696d2;">Exercise 9</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Add the following exercise to you script. Run it!</li>
</ol>
<pre><code>storms |&gt;  
  filter(category &gt; 0) |&gt;
  distinct(name, year) |&gt;
  count(year) |&gt;
  ggplot() + 
  geom_line(mapping = aes(x = year, y = n))</code></pre>
<ol start="2" type="1">
<li>Add <code>geom_point()</code> after <code>geom_line()</code> with the same aesthetic mappings.</li>
</ol>
</div>
</div>
</section>
</section>
<section id="layers-bonus" class="level3" data-number="4.4.9">
<h3 data-number="4.4.9" class="anchored" data-anchor-id="layers-bonus"><span class="header-section-number">4.4.9</span> Layers (bonus!):</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Layers</strong> allow for multiple geometric objects to be plotted in the same data visualization.</p>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color:#1696d2;">Exercise 10</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Add the following exercise to you script. Run it!</li>
</ol>
<pre><code>ggplot(data = storms, mapping = aes(x = pressure, y = wind)) + 
  geom_point() +
  geom_smooth()</code></pre>
</div>
</div>
</section>
<section id="inheritances-bonus" class="level3" data-number="4.4.10">
<h3 data-number="4.4.10" class="anchored" data-anchor-id="inheritances-bonus"><span class="header-section-number">4.4.10</span> Inheritances (bonus!):</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Inheritances</strong> pass aesthetic mappings from <code>ggplot()</code> to later <code>geom_*()</code> functions.</p>
</div>
</div>
<p>Notice how the aesthetic mappings are passed to <code>ggplot()</code> in example 10. This is useful when using layers!</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span style="color:#1696d2;">Exercise 11</span>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Pick your favorite plot from exercises 1 through 10 and duplicate the code.</p></li>
<li><p>Add <code>ggsave(filename = "favorite-plot.png")</code> on a new line without <code>+</code> and then save the file. Look at the saved file.</p></li>
<li><p>Add <code>width = 6</code> and <code>height = 4</code> to <code>ggsave()</code>. Run the code and then look at the saved file.</p></li>
</ol>
</div>
</div>
</section>
</section>
<section id="summary" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="summary"><span class="header-section-number">4.5</span> Summary</h2>
<section id="functions" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="functions"><span class="header-section-number">4.5.1</span> Functions</h3>
<p>This is a summary of the functions we discussed in this chapter. While by no means comprehensive, these are an excellent starting point to visualizing data using ggplot2.</p>
<ul>
<li><code>ggplot()</code></li>
<li><code>aes()</code></li>
<li><code>geom_*()</code>
<ul>
<li><code>geom_point()</code></li>
<li><code>geom_line()</code></li>
<li><code>geom_col()</code><br>
</li>
</ul></li>
<li><code>scale_*()</code>
<ul>
<li><code>scale_y_continuous()</code></li>
</ul></li>
<li><code>coord_*()</code></li>
<li><code>facet_*()</code></li>
<li><code>labs()</code></li>
</ul>
</section>
<section id="theory" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="theory"><span class="header-section-number">4.5.2</span> Theory</h3>
<ol type="1">
<li><em>Data</em></li>
<li><em>Aesthetic mappings</em></li>
<li><em>Geometric objects</em></li>
<li><em>Scales</em></li>
<li><em>Coordinate systems</em></li>
<li><em>Facets</em></li>
<li><em>Statistical transformations</em></li>
<li><em>Theme</em></li>
</ol>
</section>
<section id="resources" class="level3" data-number="4.5.3">
<h3 data-number="4.5.3" class="anchored" data-anchor-id="resources"><span class="header-section-number">4.5.3</span> Resources</h3>
<ul>
<li><a href="https://urbaninstitute.github.io/r-at-urban/graphics-guide.html">Urban Institute R Users Group website</a></li>
<li><a href="https://medium.com/@urban_institute/why-the-urban-institute-visualizes-data-with-ggplot2-46d8cfc7ee67">Why the Urban Institute visualizes data with ggplot2</a></li>
<li><a href="http://r4ds.had.co.nz/data-visualisation.html">R for Data Science: data visualization</a></li>
<li><a href="https://ggplot2-book.org">ggplot2: ELegant Graphics for Data Analysis (3e)</a></li>
<li><a href="https://awunderground.github.io/ggplot2-themes/">awunderground themes</a></li>
<li><a href="https://www.r-graph-gallery.com/">R Graph Gallery</a></li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-layered-grammar" class="csl-entry" role="listitem">
Wickham, Hadley. 2010. <span>“A Layered Grammar of Graphics.”</span> <em>Journal of Computational and Graphical Statistics</em> 19 (1): 3–28. <a href="https://doi.org/10.1198/jcgs.2009.07098">https://doi.org/10.1198/jcgs.2009.07098</a>.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p><code>facet_geo</code> organizes charts in a way that attempts to preserve some geographic component of the data. It is beyond the scope of this course. You can learn more at the <a href="https://cran.r-project.org/web/packages/geofacet/vignettes/geofacet.html">geofacet package vignette</a> website.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03_advanced-data-cleaning.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Advanced Data Cleaning</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05_exploratory-data-analysis.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>